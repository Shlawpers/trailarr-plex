import{a as Ae,c as Oe}from"./chunk-F2UT2QAQ.js";import{a as Te,b as oe}from"./chunk-REYD4RT4.js";import{$ as M,$a as le,A as Le,Aa as j,B as ve,C as D,D as Ce,E as He,Ea as ze,F as z,Fa as Q,G as l,Ga as te,H as Ne,Ha as je,I as T,J as S,Ka as We,L as Ze,M as Re,N as v,Na as ie,O as f,Oa as Ke,P as B,Pa as Ye,Q as Ue,Qa as Xe,R as b,Ra as Je,S as H,Sa as et,T as N,Ta as ne,U as Z,Ua as tt,V as o,Va as it,W as r,Wa as nt,X as m,Xa as ot,Ya as re,Za as G,_ as R,_a as ae,a as qe,aa as g,b as Fe,ba as p,bb as Se,ca as Ve,cb as be,da as P,db as rt,ea as xe,eb as se,fa as Me,fb as at,ga as we,h as Ie,ha as E,hb as ye,ib as lt,ja as s,jb as st,ka as w,kb as ct,l as ge,la as y,lb as dt,m as he,mb as mt,na as Be,nb as pt,oa as Qe,ob as ut,p as X,pa as Ge,qb as gt,r as J,s as _e,sb as ht,t as De,ta as $e,tb as $,u as h,ub as ce,v as _,va as ee,vb as U,w as u,wa as q,wb as de,x,xa as F,ya as I,z as fe}from"./chunk-SM7CZHZO.js";var ft=(()=>{class t{constructor(e){this.http=e,this.logsUrl=U.apiUrl+U.logs}getLogs(){return this.http.get(this.logsUrl)}downloadLogs(){return this.http.get(this.logsUrl+"download",{responseType:"blob"})}static{this.\u0275fac=function(i){return new(i||t)(J(ie))}}static{this.\u0275prov=X({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Vt(t,d){t&1&&(o(0,"div",9),m(1,"div",10)(2,"div",10)(3,"div",10)(4,"div",10),r())}function At(t,d){t&1&&R(0)}function Dt(t,d){t&1&&R(0)}function Ht(t,d){t&1&&R(0)}function Nt(t,d){t&1&&R(0)}function Zt(t,d){t&1&&R(0)}function Rt(t,d){if(t&1&&(o(0,"div",21)(1,"details")(2,"summary")(3,"p",22)(4,"i",23),v(5,At,1,0,"ng-container",24)(6,Dt,1,0,"ng-container",24)(7,Ht,1,0,"ng-container",24)(8,Nt,1,0,"ng-container",24)(9,Zt,1,0,"ng-container",24),r(),o(10,"strong"),s(11),r(),s(12),r(),o(13,"small",25),s(14),q(15,"timeago"),r()(),o(16,"p",26),s(17),r()()()),t&2){let e=d.$implicit;p(2);let i=E(7),n=E(9),a=E(11),c=E(13),C=E(15);l(3),Ue("logs-text ",e.level.toLowerCase(),""),P("title","",e.level.toLowerCase()," log"),l(2),f("ngIf",e.level=="DEBUG")("ngIfThen",i),l(),f("ngIf",e.level=="INFO")("ngIfThen",n),l(),f("ngIf",e.level=="WARNING")("ngIfThen",a),l(),f("ngIf",e.level=="ERROR")("ngIfThen",c),l(),f("ngIf",e.level=="OTHER")("ngIfThen",C),l(2),y("",e.module,": "),l(),y("",e.message," "),l(2),w(F(15,19,e.datetime)),l(3),w(e.raw_log)}}function Ut(t,d){if(t&1){let e=M();o(0,"div",11)(1,"i",12),g("click",function(){h(e);let n=p();return _(n.getLogs())}),u(),o(2,"svg",13),m(3,"path",14),r()(),x(),o(4,"form",15),m(5,"input",16),r(),o(6,"a",17),u(),o(7,"svg",13),m(8,"path",18),r()()(),x(),o(9,"div",19),v(10,Rt,18,21,"div",20),r()}if(t&2){let e=p();l(),B("loading",e.isUpdating),l(4),f("formControl",e.searchForm),l(5),f("ngForOf",e.filtered_logs)}}function Bt(t,d){t&1&&(u(),o(0,"svg",27),m(1,"path",28),r())}function Qt(t,d){t&1&&(u(),o(0,"svg",27),m(1,"path",29),r())}function Gt(t,d){t&1&&(u(),o(0,"svg",27),m(1,"path",30),r())}function $t(t,d){t&1&&(u(),o(0,"svg",27),m(1,"path",31),r())}function zt(t,d){t&1&&(u(),o(0,"svg",27),m(1,"path",32),r())}var Ct=(()=>{class t{constructor(e){this.logsService=e,this.title="Logs",this.isLoading=!0,this.isUpdating=!1,this.all_logs=[],this.searchQuery="",this.searchForm=new be,this.filtered_logs=[],this.searchForm.valueChanges.pipe(ge(400),he()).subscribe(i=>{this.onSearch(i)})}ngOnInit(){this.isLoading=!0,this.getLogs()}getLogs(){this.isUpdating=!0,this.logsService.getLogs().subscribe(e=>{this.all_logs=e,this.filtered_logs=e,this.isLoading=!1,this.isUpdating=!1})}onSearch(e=""){if(e.length<3){this.filtered_logs=this.all_logs;return}e.trim()!==this.searchQuery&&(this.searchQuery=e,this.filtered_logs=this.all_logs.filter(i=>i.raw_log.toLowerCase().includes(this.searchQuery.toLowerCase())))}static{this.\u0275fac=function(i){return new(i||t)(T(ft))}}static{this.\u0275cmp=S({type:t,selectors:[["app-logs"]],decls:16,vars:3,consts:[["logsLoaded",""],["debugLog",""],["infoLog",""],["warningLog",""],["errorLog",""],["otherLog",""],[1,"logs-container"],[1,"logs-title","text-center"],["class","loading-wave center",4,"ngIf","ngIfElse"],[1,"loading-wave","center"],[1,"loading-bar"],[1,"logssearch"],["title","Refresh",1,"icononly-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960",1,"refresh-icon"],["d","M343-107q-120-42-194.5-146.5T74-490q0-29 4-57.5T91-604l-57 33-37-62 185-107 106 184-63 36-54-92q-13 30-18.5 60.5T147-490q0 113 65.5 200T381-171l-38 64Zm291-516v-73h107q-47-60-115.5-93.5T480-823q-66 0-123.5 24T255-734l-38-65q54-45 121-71t142-26q85 0 160.5 33T774-769v-67h73v213H634ZM598-1 413-107l107-184 62 37-54 94q123-17 204.5-110.5T814-489q0-19-2.5-37.5T805-563h74q4 18 6 36.5t2 36.5q0 142-87 251.5T578-96l56 33-36 62Z"],["id","searchForm",1,"logssearch-form"],["type","text","autocomplete","off","name","query","placeholder","Filter logs...","aria-label","filter logs",3,"formControl"],["title","Download Logs","href","/api/v1/logs/download","download","",1,"icononly-button"],["d","M480-313 287-506l43-43 120 120v-371h60v371l120-120 43 43-193 193ZM220-160q-24 0-42-18t-18-42v-143h60v143h520v-143h60v143q0 24-18 42t-42 18H220Z"],[1,"logs-table"],["class","logs-row",4,"ngFor","ngForOf"],[1,"logs-row"],[3,"title"],[1,"logs-icon"],[4,"ngIf","ngIfThen"],[1,"logs-dt"],[1,"logs-raw"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960"],["d","M320-242 80-482l242-242 43 43-199 199 197 197-43 43Zm318 2-43-43 199-199-197-197 43-43 240 240-242 242Z"],["d","M453-280h60v-240h-60v240Zm26.98-314q14.02 0 23.52-9.2T513-626q0-14.45-9.48-24.22-9.48-9.78-23.5-9.78t-23.52 9.78Q447-640.45 447-626q0 13.6 9.48 22.8 9.48 9.2 23.5 9.2Zm.29 514q-82.74 0-155.5-31.5Q252-143 197.5-197.5t-86-127.34Q80-397.68 80-480.5t31.5-155.66Q143-709 197.5-763t127.34-85.5Q397.68-880 480.5-880t155.66 31.5Q709-817 763-763t85.5 127Q880-563 880-480.27q0 82.74-31.5 155.5Q817-252 763-197.68q-54 54.31-127 86Q563-80 480.27-80Zm.23-60Q622-140 721-239.5t99-241Q820-622 721.19-721T480-820q-141 0-240.5 98.81T140-480q0 141 99.5 240.5t241 99.5Zm-.5-340Z"],["d","m40-120 440-760 440 760H40Zm104-60h672L480-760 144-180Zm340.18-57q12.82 0 21.32-8.68 8.5-8.67 8.5-21.5 0-12.82-8.68-21.32-8.67-8.5-21.5-8.5-12.82 0-21.32 8.68-8.5 8.67-8.5 21.5 0 12.82 8.68 21.32 8.67 8.5 21.5 8.5ZM454-348h60v-224h-60v224Zm26-122Z"],["d","M479.91-120q-28.91 0-49.41-20.59-20.5-20.59-20.5-49.5t20.59-49.41q20.59-20.5 49.5-20.5t49.41 20.59q20.5 20.59 20.5 49.5t-20.59 49.41q-20.59 20.5-49.5 20.5ZM410-360v-480h140v480H410Z"],["d","M477.03-246Q493-246 504-257.03q11-11.03 11-27T503.97-311q-11.03-11-27-11T450-310.97q-11 11.03-11 27T450.03-257q11.03 11 27 11ZM444-394h57q0-31 10-50.5t34.72-44.22Q579-522 592-547.5t13-53.5q0-53-34-84t-91.52-31q-51.87 0-88.17 24.5Q355-667 338-624l53 22q14-28 36.2-42.5Q449.4-659 479-659q32 0 50.5 16t18.5 44.1q0 19.9-11 38.4T500-517q-37 35-46.5 60t-9.5 63ZM180-120q-24 0-42-18t-18-42v-600q0-24 18-42t42-18h600q24 0 42 18t18 42v600q0 24-18 42t-42 18H180Zm0-60h600v-600H180v600Zm0-600v600-600Z"]],template:function(i,n){if(i&1&&(o(0,"div",6)(1,"h1",7),s(2),r(),v(3,Vt,5,0,"div",8)(4,Ut,11,4,"ng-template",null,0,I),r(),v(6,Bt,2,0,"ng-template",null,1,I)(8,Qt,2,0,"ng-template",null,2,I)(10,Gt,2,0,"ng-template",null,3,I)(12,$t,2,0,"ng-template",null,4,I)(14,zt,2,0,"ng-template",null,5,I)),i&2){let a=E(5);l(2),w(n.title),l(),f("ngIf",n.isLoading)("ngIfElse",a)}},dependencies:[te,Q,$,se,re,ae,le,Se,ce,ye,oe,Te],styles:[".logs-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.logs-title[_ngcontent-%COMP%]{position:sticky;top:76px;margin:0;padding:1rem;background-color:var(--color-surface-container-high);z-index:2}@media (width < 765px){.logs-title[_ngcontent-%COMP%]{top:62px}}.text-center[_ngcontent-%COMP%]{text-align:center}.center[_ngcontent-%COMP%]{margin:auto}.logssearch[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;width:auto;flex-grow:1;padding:1rem;background-color:var(--color-surface-container-high);position:sticky;top:145px;z-index:2;gap:.5rem}@media (width < 765px){.logssearch[_ngcontent-%COMP%]{padding:.5rem;top:113px}}.refresh-icon[_ngcontent-%COMP%]{cursor:pointer;fill:var(--color-on-surface)}.loading[_ngcontent-%COMP%]{cursor:progress;animation:spin-animation 2s linear infinite}.logssearch-form[_ngcontent-%COMP%]{width:100%}.logssearch-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid var(--color-outline);border-radius:.5rem;margin:0;font-size:1rem;background-color:var(--color-surface-container-highest);color:var(--color-on-surface)}.logssearch-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:var(--color-primary);border:1px solid var(--color-primary)}.logs-table[_ngcontent-%COMP%]{padding:1rem}.logs-row[_ngcontent-%COMP%]{padding:10px;border-bottom:1px solid #e0e0e0}@media (width < 765px){.logs-row[_ngcontent-%COMP%]{padding:0}}.logs-row[_ngcontent-%COMP%]   details[_ngcontent-%COMP%]{width:100%;list-style-position:outside}.logs-row[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{list-style-position:outside;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:1rem;cursor:pointer;position:relative}@media (width < 765px){.logs-row[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{flex-direction:column;align-items:baseline;gap:0;margin-bottom:1rem}}summary[_ngcontent-%COMP%]   .logs-text[_ngcontent-%COMP%]{flex:1;margin-left:2rem}.logs-icon[_ngcontent-%COMP%]{position:absolute;top:.75rem;left:0;font-size:0;z-index:0}.logs-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:1.5rem;fill:var(--color-outline)}summary[_ngcontent-%COMP%]   .debug[_ngcontent-%COMP%]{color:var(--color-info)}summary[_ngcontent-%COMP%]   .debug[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--color-info)}summary[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]{color:var(--color-danger)}summary[_ngcontent-%COMP%]   .warning[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--color-danger)}summary[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:var(--color-warning)}summary[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--color-warning)}"]})}}return t})();var xt=(()=>{class t{constructor(e){this.el=e,this.nearEnd=new fe,this.threshold=200}ngOnInit(){this.window=window}windowScrollEvent(e){let i=this.window.document.documentElement.scrollHeight,n=this.el.nativeElement.scrollHeight,a=this.window.scrollY,c=this.window.innerHeight,C=i-n;n-c-a+C<this.threshold&&this.nearEnd.emit()}static{this.\u0275fac=function(i){return new(i||t)(T(ve))}}static{this.\u0275dir=Ze({type:t,selectors:[["","appScrollNearEnd",""]],hostBindings:function(i,n){i&1&&g("scroll",function(c){return n.windowScrollEvent(c)},!1,He)},inputs:{threshold:"threshold"},outputs:{nearEnd:"nearEnd"}})}}return t})();var Ee=function(t){return t.EQUALS="EQUALS",t}(Ee||{}),L=function(t){return t.IS_AFTER="IS_AFTER",t.IS_BEFORE="IS_BEFORE",t.IN_THE_LAST="IN_THE_LAST",t.NOT_IN_THE_LAST="NOT_IN_THE_LAST",t.EQUALS="EQUALS",t.NOT_EQUALS="NOT_EQUALS",t}(L||{}),A=function(t){return t.GREATER_THAN="GREATER_THAN",t.GREATER_THAN_EQUAL="GREATER_THAN_EQUAL",t.LESS_THAN="LESS_THAN",t.LESS_THAN_EQUAL="LESS_THAN_EQUAL",t.EQUALS="EQUALS",t.NOT_EQUALS="NOT_EQUALS",t}(A||{}),O=function(t){return t.CONTAINS="CONTAINS",t.NOT_CONTAINS="NOT_CONTAINS",t.EQUALS="EQUALS",t.NOT_EQUALS="NOT_EQUALS",t.STARTS_WITH="STARTS_WITH",t.NOT_STARTS_WITH="NOT_STARTS_WITH",t.ENDS_WITH="ENDS_WITH",t.NOT_ENDS_WITH="NOT_ENDS_WITH",t.IS_EMPTY="IS_EMPTY",t.IS_NOT_EMPTY="IS_NOT_EMPTY",t}(O||{}),W=["arr_monitored","is_movie","media_exists","monitor","trailer_exists"],me=["added_at","downloaded_at","updated_at"],pe=["arr_id","connection_id","id","runtime","year"],ue=["clean_title","folder_path","imdb_id","language","media_filename","overview","status","studio","title","title_slug","txdb_id","youtube_trailer_id"],K=function(t){return t.HOME="HOME",t.MOVIES="MOVIES",t.SERIES="SERIES",t.TRAILER="TRAILER",t}(K||{});var ke=(()=>{class t{constructor(e){this.httpClient=e,this.cp_url=U.apiUrl+U.customfilters}create(e){return this.httpClient.post(this.cp_url,e)}update(e){let i=this.cp_url+e.id;return this.httpClient.put(i,e)}delete(e){let i=this.cp_url+e;return this.httpClient.delete(i)}getViewFilters(e){let i=e==null?"home":e?"movie":"series",n=this.cp_url+i;return this.httpClient.get(n)}static{this.\u0275fac=function(i){return new(i||t)(J(ie))}}static{this.\u0275prov=X({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function jt(t,d){t&1&&(o(0,"div",0),m(1,"div",2)(2,"div",2)(3,"div",2)(4,"div",2),r())}function Wt(t,d){if(t&1&&(o(0,"option",16),s(1),r()),t&2){let e=d.$implicit,i=p(3);f("value",e),l(),y(" ",i.displayTitle(e)," ")}}function Kt(t,d){if(t&1&&(o(0,"option",16),s(1),r()),t&2){let e=d.$implicit,i=p(3);f("value",e),l(),y(" ",i.displayTitle(e)," ")}}function Yt(t,d){if(t&1&&m(0,"input",18),t&2){let e=p().$index;P("id","filter_value_",e,"")}}function Xt(t,d){if(t&1&&m(0,"input",19),t&2){let e=p().$index;P("id","filter_value_",e,"")}}function Jt(t,d){if(t&1&&(m(0,"input",25),o(1,"span"),s(2," days"),r()),t&2){let e=p().$index;P("id","filter_value_",e,"")}}function ei(t,d){if(t&1&&m(0,"input",20),t&2){let e=p().$index;P("id","filter_value_",e,"")}}function ti(t,d){if(t&1&&(o(0,"select",21)(1,"option",26),s(2,"True"),r(),o(3,"option",27),s(4,"False"),r()()),t&2){let e=p().$index;P("id","filter_value_",e,"")}}function ii(t,d){if(t&1){let e=M();o(0,"div",8)(1,"div",4)(2,"select",14),g("change",function(n){let a=h(e).$index,c=p(2);return _(c.onFilterByChange(n,a))}),o(3,"option",15),s(4,"Select Filter By"),r(),N(5,Wt,2,2,"option",16,H),r()(),o(7,"div",4)(8,"select",17),g("change",function(n){let a=h(e).$index,c=p(2);return _(c.onFilterConditionChange(n,a))}),o(9,"option",15),s(10,"Select Condition"),r(),N(11,Kt,2,2,"option",16,H),r()(),o(13,"div",4),v(14,Yt,1,2,"input",18)(15,Xt,1,2,"input",19)(16,Jt,3,2)(17,ei,1,2,"input",20)(18,ti,5,2,"select",21),r(),o(19,"button",22),g("click",function(){let n=h(e).$index,a=p(2);return _(a.removeFilter(n))}),u(),o(20,"svg",23),m(21,"path",24),r()()()}if(t&2){let e=d.$index,i=p(2);f("formGroupName",e),l(2),P("id","filter_by_",e,""),l(3),Z(i.filterKeys),l(3),P("id","filter_condition_",e,""),l(3),Z(i.filterConditions[e]),l(3),b(i.filterValueTypes[e]==="string"?14:i.filterValueTypes[e]==="number"?15:i.filterValueTypes[e]==="number_days"?16:i.filterValueTypes[e]==="date"?17:i.filterValueTypes[e]==="boolean"?18:-1)}}function ni(t,d){if(t&1&&(o(0,"button",12),s(1," Submit "),r()),t&2){let e=p(2);f("disabled",e.customFilterForm.pristine||e.customFilterForm.invalid||e.submitting)}}function oi(t,d){t&1&&(o(0,"div",13),u(),o(1,"svg",28)(2,"circle",29),m(3,"animate",30),r(),o(4,"circle",31),m(5,"animate",32),r(),o(6,"circle",33),m(7,"animate",34),r()()())}function ri(t,d){if(t&1){let e=M();o(0,"form",3),g("ngSubmit",function(){h(e);let n=p();return _(n.onSubmit())})("click",function(n){return h(e),_(n.stopPropagation())}),o(1,"div",4)(2,"label",5),s(3,"Label"),r(),m(4,"input",6),r(),o(5,"div",7),N(6,ii,22,6,"div",8,H),o(8,"button",9),g("click",function(){h(e);let n=p();return _(n.addFilter())}),s(9,"Add Filter"),r()(),o(10,"div",10)(11,"button",11),g("click",function(){h(e);let n=p();return _(n.closeDialog())}),s(12,"Cancel"),r(),v(13,ni,2,1,"button",12)(14,oi,8,0,"div",13),r()()}if(t&2){let e=p();f("formGroup",e.customFilterForm),l(6),Z(e.filters.controls),l(7),b(e.submitting?14:13)}}var Mt=(()=>{class t{constructor(e){this.fb=e,this.filterType=Le.required(),this.filterTypeValue=j(()=>{let i=this.filterType().toUpperCase();return i=="MOVIES"?K.MOVIES:i=="SERIES"?K.SERIES:i=="TRAILER"?K.TRAILER:K.HOME}),this.customFilter=Le(null),this.dialogClosed=new fe,this.isLoading=!0,this.customfilterService=_e(ke),this.computedSignal=j(()=>{let i=this.customFilter();return this.initForm(i),!0}),this.boolFilterConditions=Object.values(Ee),this.dateFilterConditions=Object.values(L),this.numberFilterConditions=Object.values(A),this.stringFilterConditions=Object.values(O),this.filterConditions=[],this.filterValueTypes=[],this.filterKeys=W.concat(me,pe,ue).sort(),this.viewForOptions=Object.values(K),this.submitting=!1}ngOnInit(){this.initForm(this.customFilter())}closeDialog(){this.dialogClosed.emit(),this.filters.clear(),this.addFilter(),this.customFilterForm.reset()}displayTitle(e){return e.toLowerCase().replace(/_/g," ").replace(/\b\w/g,i=>i.toUpperCase())}initForm(e){let i=this.fb.group({id:[e?e.id:null],filter_type:[e?e.filter_type:this.filterTypeValue(),G.required],filter_name:[e?e.filter_name:"",[G.required,G.maxLength(15)]],filters:this.fb.array([],G.required)});return this.customFilterForm=i,e&&e.filters&&e.filters.length?e.filters.forEach(n=>{this.addFilter(n)}):this.addFilter(),this.isLoading=!1,i}get filters(){return this.customFilterForm.get("filters")}createFilter(e){return this.fb.group({id:[e?e.id:null],filter_by:[e?e.filter_by:"",G.required],filter_condition:[e?e.filter_condition:"",G.required],filter_value:[e?e.filter_value:"",G.required],customfilter_id:[e?e.customfilter_id:null]})}getFilterConditions(e){return W.includes(e)?this.boolFilterConditions:me.includes(e)?this.dateFilterConditions:pe.includes(e)?this.numberFilterConditions:ue.includes(e)?this.stringFilterConditions:[]}getFilterValueType(e,i){return W.includes(e)?"boolean":me.includes(e)?i===L.IN_THE_LAST||i===L.NOT_IN_THE_LAST?"number_days":"date":pe.includes(e)?"number":"string"}addFilter(e){e&&e.filter_by?(this.filterConditions.push(this.getFilterConditions(e.filter_by)),this.filterValueTypes.push(this.getFilterValueType(e.filter_by,e.filter_condition))):(this.filterConditions.push([]),this.filterValueTypes.push("string")),this.filters.push(this.createFilter(e))}removeFilter(e){this.filterConditions.splice(e,1),this.filters.removeAt(e)}onFilterByChange(e,i){let n=this.filters.at(i).get("filter_by")?.value;this.filterConditions[i]=this.getFilterConditions(n),this.filterValueTypes[i]=this.getFilterValueType(n,""),this.filters.at(i).get("filter_condition")?.setValue(""),W.includes(n)&&this.filters.at(i).get("filter_condition")?.setValue(Ee.EQUALS),this.filters.at(i).get("filter_value")?.reset()}onFilterConditionChange(e,i){let n=this.filters.at(i).get("filter_by")?.value;if(e.target){let a=e.target.value;this.filterValueTypes[i]=this.getFilterValueType(n,a)}this.filters.at(i).get("filter_value")?.reset()}onSubmit(){if(!this.submitting)if(this.submitting=!0,this.customFilterForm.valid){let e=this.customFilterForm.value;e.filters.forEach(i=>{i.filter_value=i.filter_value.toString()}),this.customFilter()?.id?this.customfilterService.update(e).subscribe(()=>{this.closeDialog(),this.submitting=!1}):this.customfilterService.create(e).subscribe(()=>{this.closeDialog(),this.submitting=!1})}else console.log("Form is invalid"),this.customFilterForm.markAllAsTouched(),this.submitting=!1}static{this.\u0275fac=function(i){return new(i||t)(T(ht))}}static{this.\u0275cmp=S({type:t,selectors:[["app-add-filter-dialog"]],inputs:{filterType:[1,"filterType"],customFilter:[1,"customFilter"]},outputs:{dialogClosed:"dialogClosed"},decls:2,vars:1,consts:[[1,"loading-wave","center"],[3,"formGroup"],[1,"loading-bar"],[3,"ngSubmit","click","formGroup"],[1,"form-group"],["for","filter_name"],["id","filter_name","type","text","maxlength","15","formControlName","filter_name"],["formArrayName","filters",1,"filters-container"],[1,"filter-group",3,"formGroupName"],["type","button",1,"secondary",3,"click"],[1,"buttons-row"],["type","button",1,"danger",3,"click"],["type","submit",1,"primary",3,"disabled"],["title","Submitting form data"],["formControlName","filter_by",3,"change","id"],["value","","disabled",""],[3,"value"],["formControlName","filter_condition",3,"change","id"],["type","text","formControlName","filter_value",3,"id"],["type","number","formControlName","filter_value",3,"id"],["type","date","formControlName","filter_value",3,"id"],["formControlName","filter_value",3,"id"],["type","button",1,"danger","icononly-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960"],["d","M253-99q-38.21 0-65.11-26.6Q161-152.2 161-190v-552h-58v-91h228v-47h297v47h228v91h-58v552q0 37.18-27.21 64.09Q743.59-99 706-99H253Zm453-643H253v552h453v-552ZM357-268h74v-398h-74v398Zm173 0h75v-398h-75v398ZM253-742v552-552Z"],["type","number","placeholder","days","formControlName","filter_value",3,"id"],["value","true"],["value","false"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 200 200",1,"icon-loading"],["stroke-width","14","r","15","cx","40","cy","65"],["attributeName","cy","calcMode","spline","dur","2","values","65;135;65;","keySplines",".5 0 .5 1;.5 0 .5 1","repeatCount","indefinite","begin","-.4"],["stroke-width","14","r","15","cx","100","cy","65"],["attributeName","cy","calcMode","spline","dur","2","values","65;135;65;","keySplines",".5 0 .5 1;.5 0 .5 1","repeatCount","indefinite","begin","-.2"],["stroke-width","14","r","15","cx","160","cy","65"],["attributeName","cy","calcMode","spline","dur","2","values","65;135;65;","keySplines",".5 0 .5 1;.5 0 .5 1","repeatCount","indefinite","begin","0"]],template:function(i,n){i&1&&v(0,jt,5,0,"div",0)(1,ri,15,2,"form",1),i&2&&b(n.isLoading?0:1)},dependencies:[$,se,pt,ut,re,at,mt,ae,le,gt,ce,lt,dt,st,ct],styles:["[_nghost-%COMP%]{display:contents}form[_ngcontent-%COMP%]{padding:1rem;display:block flex;flex-direction:column;gap:1rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.4rem;font-weight:700}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{padding:.5rem;box-sizing:border-box}option[_ngcontent-%COMP%]{background-color:var(--color-surface-container-high)}.ng-touched.ng-invalid[_ngcontent-%COMP%]:not(form):not(div){border:2px solid var(--color-danger)}.error[_ngcontent-%COMP%]{color:var(--color-danger);font-size:.9rem;margin-top:.4rem}.filters-container[_ngcontent-%COMP%]{border-top:1px solid var(--color-outline);padding-top:1rem}.filter-group[_ngcontent-%COMP%]{display:block flex;flex-wrap:wrap;gap:1rem;align-items:center;border:1px solid var(--color-outline);border-radius:.5rem;padding:.5rem;margin-bottom:.75rem;background-color:var(--color-surface-container-high)}.filter-group[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:nth-child(3){flex:1;text-align:start}.danger[_ngcontent-%COMP%]{width:auto;height:auto}.danger[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--color-danger-text)}.buttons-row[_ngcontent-%COMP%]{display:block flex;align-items:center;justify-content:space-around}.icon-loading[_ngcontent-%COMP%]{width:1.5rem;height:1.5rem;fill:var(--color-on-surface)}"]})}}return t})();var wt=(()=>{class t{transform(e){return e=e.replace("_at",""),e.charAt(0).toUpperCase()+e.slice(1)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=Re({name:"displayTitle",type:t,pure:!0})}}return t})();var si=["addFilterDialog"],St=t=>({media:t}),ci=t=>["/media",t];function di(t,d){t&1&&(u(),o(0,"svg",13),m(1,"path",24),r())}function mi(t,d){t&1&&(u(),o(0,"svg",13),m(1,"path",25),r())}function pi(t,d){if(t&1&&(o(0,"div"),v(1,di,2,0,":svg:svg",13)(2,mi,2,0,":svg:svg",13),r()),t&2){let e=p(3);l(),b(e.sortAscending()?1:2)}}function ui(t,d){if(t&1){let e=M();o(0,"div",23),g("click",function(){let n=h(e).$implicit,a=p(2);return _(a.setMediaSort(n))}),s(1),q(2,"displayTitle"),v(3,pi,3,1,"div"),r()}if(t&2){let e=d.$implicit,i=p(2);l(),y(" ",F(2,2,e)," "),l(2),b(i.selectedSort()==e?3:-1)}}function gi(t,d){t&1&&(o(0,"div"),u(),o(1,"svg",13),m(2,"path",27),r()())}function hi(t,d){if(t&1){let e=M();o(0,"div",26),g("click",function(){let n=h(e).$implicit,a=p(2);return _(a.setMediaFilter(n))}),s(1),q(2,"displayTitle"),v(3,gi,3,0,"div"),r()}if(t&2){let e=d.$implicit,i=p(2);l(),y(" ",F(2,2,e)," "),l(2),b(i.selectedFilter()==e?3:-1)}}function _i(t,d){if(t&1){let e=M();o(0,"div",2)(1,"div",8),g("click",function(){h(e);let n=p();return _(n.inEditMode=!0)}),u(),o(2,"svg",9),m(3,"path",10),r(),x(),o(4,"span"),s(5,"Edit"),r()(),m(6,"div",11),o(7,"div",12),u(),o(8,"svg",13),m(9,"path",14),r(),x(),o(10,"div"),s(11),q(12,"displayTitle"),r(),o(13,"div",15),N(14,ui,4,4,"div",16,H),r()(),o(16,"div",17),u(),o(17,"svg",13),m(18,"path",18),r(),x(),o(19,"div"),s(20),q(21,"displayTitle"),r(),o(22,"div",19),N(23,hi,4,4,"div",20,H),o(25,"div",21),g("click",function(){h(e);let n=p();return _(n.openFilterDialog())}),o(26,"span"),s(27,"Custom Filters"),r(),u(),o(28,"svg",13),m(29,"path",22),r()()()()()}if(t&2){let e=p();l(11),y(" ",F(12,2,e.selectedSort()),""),l(3),Z(e.sortOptions),l(6),y(" ",F(21,4,e.selectedFilter())," "),l(3),Z(e.allFilters())}}function fi(t,d){if(t&1){let e=M();o(0,"div",3)(1,"div",28),g("click",function(){h(e);let n=p();return _(n.batchUpdate("monitor"))}),u(),o(2,"svg",29),m(3,"path",30),r(),x(),o(4,"span"),s(5,"Monitor"),r()(),o(6,"div",31),g("click",function(){h(e);let n=p();return _(n.batchUpdate("unmonitor"))}),u(),o(7,"svg",32),m(8,"path",33),r(),x(),o(9,"span"),s(10,"UnMonitor"),r()(),o(11,"div",34),g("click",function(){h(e);let n=p();return _(n.batchUpdate("download"))}),u(),o(12,"svg",35),m(13,"path",36),r(),x(),o(14,"span"),s(15,"Download"),r()(),o(16,"div",37),g("click",function(){h(e);let n=p();return _(n.batchUpdate("delete"))}),u(),o(17,"svg",38),m(18,"path",39),r(),x(),o(19,"span"),s(20,"Delete"),r()(),o(21,"div",40),g("click",function(){h(e);let n=p();return _(n.toggleEditMode(!1))}),u(),o(22,"svg",41),m(23,"path",42),r(),x(),o(24,"span"),s(25,"Cancel"),r()(),m(26,"div",11),o(27,"p",43)(28,"span"),s(29,"Selected: "),r(),s(30),o(31,"span"),s(32),r()(),o(33,"div",44),g("click",function(){h(e);let n=p();return _(n.selectAll())}),u(),o(34,"svg",45),m(35,"path",46),r()(),x(),o(36,"div",47),g("click",function(){h(e);let n=p();return _(n.selectedMedia=[])}),u(),o(37,"svg",45),m(38,"path",48),r()()()}if(t&2){let e=p();l(30),y(" ",e.selectedMedia.length," "),l(2),y(" / ",e.filteredSortedMedia().length,"")}}function vi(t,d){t&1&&(o(0,"div",5)(1,"div",49),m(2,"div",50)(3,"div",50)(4,"div",50)(5,"div",50),r()())}function Ci(t,d){t&1&&(o(0,"div",5),u(),o(1,"svg",52),m(2,"path",53),r(),x(),o(3,"p"),s(4,"No media items found matching the selected filter!"),r()())}function xi(t,d){t&1&&R(0)}function Mi(t,d){if(t&1){let e=M();o(0,"div",54)(1,"input",56),g("click",function(n){return h(e),_(n.stopPropagation())})("change",function(n){h(e);let a=p().$implicit,c=p(2);return _(c.onMediaSelected(a,n))}),r(),v(2,xi,1,0,"ng-container",57),r()}if(t&2){let e=p().$implicit,i=p(2),n=E(6);f("title",e.title),l(),f("id",e.id)("checked",i.selectedMedia.includes(e.id)),l(),f("ngTemplateOutlet",n)("ngTemplateOutletContext",ee(5,St,e))}}function wi(t,d){t&1&&R(0)}function Ti(t,d){if(t&1&&(o(0,"div",55),v(1,wi,1,0,"ng-container",57),r()),t&2){let e=p().$implicit;p(2);let i=E(6);f("routerLink",ee(5,ci,e.id))("title",e.title)("id",e.id),l(),f("ngTemplateOutlet",i)("ngTemplateOutletContext",ee(7,St,e))}}function Si(t,d){if(t&1&&v(0,Mi,3,7,"div",54)(1,Ti,2,9,"div",55),t&2){let e=p(2);b(e.inEditMode?0:1)}}function bi(t,d){if(t&1){let e=M();v(0,Ci,5,0,"div",5),o(1,"div",51),g("nearEnd",function(){h(e);let n=p();return _(n.onNearEndScroll())}),N(2,Si,2,1,null,null,H),r()}if(t&2){let e=p();b(e.filteredSortedMedia().length===0?0:-1),l(2),Z(e.displayMedia())}}function yi(t,d){t&1&&(u(),o(0,"svg",60)(1,"g",63)(2,"path",64),m(3,"animateTransform",65),r()()())}function Oi(t,d){t&1&&(u(),o(0,"svg",61),m(1,"path",30),r())}function Ei(t,d){if(t&1&&(u(),o(0,"svg",66),m(1,"path",67),r()),t&2){let e=p().media;B("success",e.trailer_exists)}}function ki(t,d){if(t&1){let e=M();o(0,"label",58)(1,"img",59),g("load",function(){let n=h(e).media;return _(n.isImageLoaded=!0)})("error",function(){let n=h(e).media;return _(n.isImageLoaded=!0)}),r(),o(2,"p"),s(3),r()(),v(4,yi,4,0,":svg:svg",60)(5,Oi,2,0,":svg:svg",61)(6,Ei,2,2,":svg:svg",62)}if(t&2){let e=d.media;f("for",e.id),l(),B("animated-gradient",!e.isImageLoaded),P("id","mediaImage",e.id,""),f("src",e.poster_path||"assets/poster-sm.png",Ce)("alt",e.title),l(2),w(e.title),l(),b(e.status.toLowerCase()=="downloading"?4:e.monitor?5:6)}}function Pi(t,d){if(t&1){let e=M();o(0,"app-add-filter-dialog",68),g("dialogClosed",function(){h(e);let n=p();return _(n.closeFilterDialog())}),r()}if(t&2){let e=p();f("filterType",e.moviesOnly()==null?"HOME":e.moviesOnly()?"MOVIES":"SERIES")("customFilter",e.editFilter)}}function qi(t,d){if(t&1){let e=M();o(0,"div",20)(1,"span",74),g("click",function(){let n=h(e).$implicit,a=p(2);return _(a.openFilterEditDialog(n))}),s(2),r(),u(),o(3,"svg",75),g("click",function(){let n=h(e).$implicit,a=p(2);return _(a.deleteFilter(n.id))}),m(4,"path",39),r()()}if(t&2){let e=d.$implicit;l(2),y(" ",e.filter_name," ")}}function Fi(t,d){if(t&1){let e=M();o(0,"div",69),g("click",function(n){return h(e),_(n.stopPropagation())}),o(1,"div",70),s(2,"Custom Filters"),r(),N(3,qi,5,1,"div",20,H),r(),o(5,"div",71)(6,"button",72),g("click",function(){h(e);let n=p();return _(n.closeFilterDialog())}),s(7,"Cancel"),r(),o(8,"button",73),g("click",function(){h(e);let n=p();return _(n.openFilterEditDialog(null))}),s(9,"Add New"),r()()}if(t&2){let e=p();l(3),Z(e.customFilters())}}var Pe=(()=>{class t{constructor(e,i,n){this.route=e,this.mediaService=i,this.webSocketService=n,this.customfilterService=_e(ke),this.moviesOnly=D(null),this.isLoading=D(!0),this.inEditMode=!1,this.selectedMedia=[],this.sortOptions=["title","year","added_at","updated_at"],this.filterOptions=["all","downloaded","downloading","missing","monitored","unmonitored"],this.customFilters=D([]),this.allFilters=j(()=>this.filterOptions.concat(this.customFilters().map(a=>a.filter_name))),this.selectedSort=D("added_at"),this.sortAscending=D(!0),this.selectedFilter=D("all"),this.defaultDisplayCount=50,this.displayCount=D(this.defaultDisplayCount),this.allMedia=D([]),this.filteredSortedMedia=j(()=>this.computeFilteredNSortedMedia()),this.displayMedia=j(()=>this.filteredSortedMedia().slice(0,this.displayCount())),this.isCustomFilterDialogOpen=!1,this.lastUpdateTime=0,this.UPDATE_INTERVAL=3,this.filterDisplayed=!1,this.editFilter=null}ngOnInit(){switch(this.isLoading.set(!0),this.route.snapshot.url[0].path){case"movies":this.moviesOnly.set(!0);break;case"series":this.moviesOnly.set(!1);break;default:this.moviesOnly.set(null),this.filterOptions=["all","movies","series"],this.selectedFilter.set("all"),this.selectedSort.set("updated_at"),this.sortAscending.set(!1)}this.retrieveSortNFilterOptions();let i=this.moviesOnly()==null?"downloaded":"all";this.mediaService.fetchAllMedia(this.moviesOnly(),i).subscribe(n=>{this.allMedia.set(n.map(a=>Ae(a))),this.isLoading.set(!1)}),this.webSocketService.toastMessage.subscribe(()=>{this.fetchUpdatedMedia()}),setTimeout(()=>{this.fetchUpdatedMedia()},1e4)}applyFilter(e,i){let n=e.filter_value,a=e.filter_by;if(W.includes(a)){let c=i[a],C=n.toLowerCase()==="true";return c===C}if(me.includes(a)){let c=new Date(i[a]),C=new Date(n);switch(e.filter_condition){case L.IS_AFTER:return c>C;case L.IS_BEFORE:return c<C;case L.IN_THE_LAST:let k=new Date;return k.setDate(k.getDate()-parseInt(n)),c>k;case L.NOT_IN_THE_LAST:let Y=new Date;return Y.setDate(Y.getDate()-parseInt(n)),c<Y;case L.EQUALS:return c.getDate()===C.getDate();case L.NOT_EQUALS:return c.getDate()!==C.getDate();default:return!0}}if(pe.includes(a)){let c=i[a],C=parseInt(n);switch(e.filter_condition){case A.GREATER_THAN:return c>C;case A.GREATER_THAN_EQUAL:return c>=C;case A.LESS_THAN:return c<C;case A.LESS_THAN_EQUAL:return c<=C;case A.EQUALS:return c===C;case A.NOT_EQUALS:return c!==C;default:return!0}}if(ue.includes(a)){let c=i[a];switch(e.filter_condition){case O.CONTAINS:return c.includes(n);case O.NOT_CONTAINS:return!c.includes(n);case O.EQUALS:return c===n;case O.NOT_EQUALS:return c!==n;case O.STARTS_WITH:return c.startsWith(n);case O.NOT_STARTS_WITH:return!c.startsWith(n);case O.ENDS_WITH:return c.endsWith(n);case O.NOT_ENDS_WITH:return!c.endsWith(n);case O.IS_EMPTY:return c==="";case O.IS_NOT_EMPTY:return c!=="";default:return!0}}return!0}applyCustomFilter(e,i){let n=this.customFilters().find(a=>a.filter_name===e);return this.filterDisplayed||(console.log("Custom filter:",n),this.filterDisplayed=!0),n?n.filters.every(a=>this.applyFilter(a,i)):!0}computeFilteredNSortedMedia(){this.lastUpdateTime=Date.now();let e=this.allMedia().filter(i=>{switch(this.selectedFilter()){case"all":return!0;case"downloaded":return i.trailer_exists;case"downloading":return i.status.toLowerCase()==="downloading";case"missing":return!i.trailer_exists;case"monitored":return i.monitor;case"unmonitored":return!i.monitor&&!i.trailer_exists;case"movies":return i.is_movie&&i.trailer_exists;case"series":return!i.is_movie&&i.trailer_exists;default:return this.applyCustomFilter(this.selectedFilter(),i)}});return e.sort((i,n)=>{let a=i[this.selectedSort()],c=n[this.selectedSort()];return a instanceof Date&&c instanceof Date?this.sortAscending()?a.getTime()-c.getTime():c.getTime()-a.getTime():typeof a=="number"&&typeof c=="number"?this.sortAscending()?a-c:c-a:this.sortAscending()?i[this.selectedSort()].toString().localeCompare(n[this.selectedSort()].toString()):n[this.selectedSort()].toString().localeCompare(i[this.selectedSort()].toString())}),e}fetchUpdatedMedia(e=!1){let i=Date.now(),n=Math.min(Math.floor(Math.abs(i-this.lastUpdateTime)/1e3),1e3);(n>this.UPDATE_INTERVAL||e)&&(this.mediaService.fetchUpdatedMedia(n).subscribe(a=>{let c=a.map(C=>Ae(C));this.allMedia.update(C=>C.map(k=>{let Y=c.find(Ft=>Ft.id===k.id);return Y||k}))}),this.lastUpdateTime=i)}toggleEditMode(e){this.inEditMode=e}selectAll(){this.selectedMedia=this.filteredSortedMedia().map(e=>e.id)}onMediaSelected(e,i){i.target.checked?this.selectedMedia.push(e.id):this.selectedMedia=this.selectedMedia.filter(a=>a!==e.id)}batchUpdate(e){this.webSocketService.showToast(`Batch update: ${e} ${this.selectedMedia.length} items`),this.mediaService.batchUpdate(this.selectedMedia,e).subscribe(()=>{this.fetchUpdatedMedia(!0)}),this.selectedMedia=[]}retrieveSortNFilterOptions(){let e=this.moviesOnly(),i=e==null?"AllMedia":e?"Movies":"Series";this.customfilterService.getViewFilters(e).subscribe(C=>{this.customFilters.set(C)});let n=localStorage.getItem(`Trailarr${i}Filter`);n&&this.selectedFilter.set(n);let a=localStorage.getItem(`Trailarr${i}Sort`),c=localStorage.getItem(`Trailarr${i}SortAscending`);a&&this.selectedSort.set(a),c&&this.sortAscending.set(c=="true")}setMediaSort(e){this.selectedMedia=[],this.displayCount.set(this.defaultDisplayCount),this.selectedSort()===e?this.sortAscending.set(!this.sortAscending()):(this.selectedSort.set(e),this.sortAscending.set(!0));let i=this.moviesOnly(),n=i==null?"AllMedia":i?"Movies":"Series";localStorage.setItem(`Trailarr${n}Sort`,this.selectedSort()),localStorage.setItem(`Trailarr${n}SortAscending`,this.sortAscending().toString())}setMediaFilter(e){this.selectedMedia=[],this.displayCount.set(this.defaultDisplayCount),this.selectedFilter.set(e);let i=this.moviesOnly(),n=i==null?"AllMedia":i?"Movies":"Series";localStorage.setItem(`Trailarr${n}Filter`,this.selectedFilter())}onNearEndScroll(){this.displayCount()>=this.filteredSortedMedia().length||this.displayCount.update(e=>e+this.defaultDisplayCount)}openFilterDialog(){this.addFilterDialog.nativeElement.showModal(),this.customFilters().length===0&&this.openFilterEditDialog(null)}openFilterEditDialog(e){this.editFilter=e,this.isCustomFilterDialogOpen=!0}deleteFilter(e){this.customfilterService.delete(e).subscribe(()=>{this.customFilters.update(i=>i.filter(n=>n.id!==e))})}closeFilterDialog(){this.addFilterDialog.nativeElement.close(),this.retrieveSortNFilterOptions(),setTimeout(()=>{this.isCustomFilterDialogOpen=!1},1e3)}static{this.\u0275fac=function(i){return new(i||t)(T(Xe),T(Oe),T(de))}}static{this.\u0275cmp=S({type:t,selectors:[["app-media2"]],viewQuery:function(i,n){if(i&1&&xe(si,5),i&2){let a;Me(a=we())&&(n.addFilterDialog=a.first)}},decls:11,vars:3,consts:[["mediaCard",""],["addFilterDialog",""],[1,"media-header"],[1,"media-header","edit"],[1,"media-container"],[1,"center"],[3,"close"],[3,"filterType","customFilter"],["aria-label","Edit","title","Edit",1,"media-header-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960",1,"button-icon"],["d","M640-160v-360H160v360h480Zm80-200v-80h80v-360H320v200h-80v-200q0-33 23.5-56.5T320-880h480q33 0 56.5 23.5T880-800v360q0 33-23.5 56.5T800-360h-80ZM160-80q-33 0-56.5-23.5T80-160v-360q0-33 23.5-56.5T160-600h480q33 0 56.5 23.5T720-520v360q0 33-23.5 56.5T640-80H160Zm400-603ZM400-340Z"],[1,"empty-space"],[1,"media-header-sortitem"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960",1,"icon"],["d","M74-159v-135h304v135H74Zm0-255v-134h558v134H74Zm0-254v-135h812v135H74Z"],[1,"sortitem-dropdown"],[1,"sortitem-dropdown-option"],[1,"media-header-filteritem"],["d","M371-158v-135h219v135H371ZM200-413v-135h558v135H200ZM74-668v-135h812v135H74Z"],[1,"filteritem-dropdown"],[1,"filteritem-dropdown-option"],["aria-label","CustomFilters","title","Edit",1,"filteritem-dropdown-option",3,"click"],["d","M421-97v-248h83v83h353v83H504v82h-83Zm-318-82v-83h270v83H103Zm187-178v-82H103v-82h187v-84h83v248h-83Zm131-82v-82h436v82H421Zm166-176v-248h83v82h187v83H670v83h-83Zm-484-83v-83h436v83H103Z"],[1,"sortitem-dropdown-option",3,"click"],["d","M480-130 200-410l96-96 184 185 184-185 96 96-280 280Zm0-299L200-708l96-97 184 185 184-185 96 97-280 279Z"],["d","m296-155-96-97 280-279 280 279-96 97-184-185-184 185Zm0-299-96-96 280-280 280 280-96 96-184-185-184 185Z"],[1,"filteritem-dropdown-option",3,"click"],["d","M382-200 113-469l97-97 172 173 369-369 97 96-466 466Z"],["aria-label","Monitor","title","Monitor",1,"media-header-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-label","Monitor",1,"button-icon"],["d","M713-600 600-713l56-57 57 57 141-142 57 57-198 198ZM200-120v-640q0-33 23.5-56.5T280-840h280q-20 30-30 57.5T520-720q0 72 45.5 127T680-524q23 3 40 3t40-3v404L480-240 200-120Z"],["aria-label","UnMonitor","title","UnMonitor",1,"media-header-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-label","UnMonitor",1,"button-icon"],["d","M200-120v-640q0-33 23.5-56.5T280-840h240v80H280v518l200-86 200 86v-278h80v400L480-240 200-120Zm80-640h240-240Zm400 160v-80h-80v-80h80v-80h80v80h80v80h-80v80h-80Z"],["aria-label","Download","title","Download",1,"media-header-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-label","Download",1,"button-icon"],["d","M480-320 280-520l56-58 104 104v-326h80v326l104-104 56 58-200 200ZM240-160q-33 0-56.5-23.5T160-240v-120h80v120h480v-120h80v120q0 33-23.5 56.5T720-160H240Z"],["aria-label","Delete","title","Delete",1,"media-header-button","delete",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-label","Delete",1,"button-icon"],["d","M280-120q-33 0-56.5-23.5T200-200v-520h-40v-80h200v-40h240v40h200v80h-40v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM360-280h80v-360h-80v360Zm160 0h80v-360h-80v360ZM280-720v520-520Z"],["aria-label","Cancel","title","Cancel",1,"media-header-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-label","Cancel",1,"button-icon"],["d","M819-28 407-440H160v280h480v-161l80 80v81q0 33-23.5 56.5T640-80H160q-33 0-56.5-23.5T80-160v-360q0-33 23.5-56.5T160-600h80v-7L27-820l57-57L876-85l-57 57Zm-99-327-80-80-165-165h165q33 0 56.5 23.5T720-520v80h80v-280H355L246-829q8-23 28.5-37t45.5-14h480q33 0 56.5 23.5T880-800v360q0 33-23.5 56.5T800-360h-80v5Z"],[1,"count"],["aria-label","Select All","title","Select All",1,"media-header-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-label","Clear",1,"button-icon"],["d","M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q8 0 15 1.5t14 4.5l-74 74H200v560h560v-266l80-80v346q0 33-23.5 56.5T760-120H200Zm261-160L235-506l56-56 170 170 367-367 57 55-424 424Z"],["aria-label","Clear","title","Clear",1,"media-header-button",3,"click"],["d","m500-120-56-56 142-142-142-142 56-56 142 142 142-142 56 56-142 142 142 142-56 56-142-142-142 142Zm-220 0v-80h80v80h-80Zm-80-640h-80q0-33 23.5-56.5T200-840v80Zm80 0v-80h80v80h-80Zm160 0v-80h80v80h-80Zm160 0v-80h80v80h-80Zm160 0v-80q33 0 56.5 23.5T840-760h-80ZM200-200v80q-33 0-56.5-23.5T120-200h80Zm-80-80v-80h80v80h-80Zm0-160v-80h80v80h-80Zm0-160v-80h80v80h-80Zm640 0v-80h80v80h-80Z"],[1,"loading-wave"],[1,"loading-bar"],["appScrollNearEnd","",1,"media-row",3,"nearEnd"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960",1,"empty-icon"],["d","M215.38-160q-23.05 0-39.22-16.16Q160-192.33 160-215.38v-529.24q0-23.05 16.16-39.22Q192.33-800 215.38-800h529.24q23.05 0 39.22 16.16Q800-767.67 800-744.62V-418q-7.33-4.55-15.4-7.82-8.08-3.27-15.37-6.8v-185.84H495.38v201.61q-10.84 6.39-22.26 13.54-11.43 7.16-21.89 14.85H190.77v173.08q0 10.76 6.92 17.69 6.93 6.92 17.69 6.92h128.16q6.15 8.54 12.42 16.12 6.27 7.57 12.66 14.65H215.38Zm-24.61-259.23h273.85v-199.23H190.77v199.23Zm0-230h578.46v-95.39q0-10.76-6.92-17.69-6.93-6.92-17.69-6.92H215.38q-10.76 0-17.69 6.92-6.92 6.93-6.92 17.69v95.39ZM480-480Zm0 0Zm0 0Zm0 0ZM650.37-98.46q-71.22 0-131.91-36.54t-97.23-97.31q36.54-60.77 97.23-97.31 60.69-36.53 132.16-36.53 71.46 0 131.76 36.53 60.31 36.54 97.62 97.81-36.08 61.27-97.25 97.31T650.37-98.46Zm.25-30.77q57.76 0 108.07-28.35 50.31-28.34 85.08-74.73-34.77-46.38-84.9-74.73-50.12-28.34-108.64-28.34-57.38 0-108.08 28.34-50.69 28.35-84.69 74.73 34 46.39 84.69 74.73 50.7 28.35 108.47 28.35Zm-.12-67.69q-15.12 0-25.38-10.44-10.27-10.43-10.27-25.11t10.42-24.95q10.41-10.27 25.08-10.27 15.5 0 25.38 10.43 9.89 10.43 9.89 25.12 0 14.68-10.01 24.95-10 10.27-25.11 10.27Z"],[1,"media-card",3,"title"],[1,"media-card",3,"routerLink","title","id"],["type","checkbox",1,"media-card-checkbox",3,"click","change","id","checked"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"for"],["loading","lazy",3,"load","error","id","src","alt"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-label","Downloading",1,"monitored-icon"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-label","Monitored",1,"monitored-icon"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-label","Trailer Exists",1,"downloaded-icon",3,"success"],["transform","scale(0.9) translate(65,-60)"],["d","M343 -107q-120 -42 -194.5 -146.5T74 -490q0 -29 4 -57.5T91 -604l-57 33 -37 -62 185 -107 106 184 -63 36 -54 -92q-13 30 -18.5 60.5T147 -490q0 113 65.5 200T381 -171zm291 -516v-73h107q-47 -60 -115.5 -93.5T480 -823q-66 0 -123.5 24T255 -734l-38 -65q54 -45 121 -71t142 -26q85 0 160.5 33T774 -769v-67h73v213zM598 -1 413 -107l107 -184 62 37 -54 94q123 -17 204.5 -110.5T814 -489q0 -19 -2.5 -37.5T805 -563h74q4 18 6 36.5t2 36.5q0 142 -87 251.5T578 -96l56 33z"],["attributeName","transform","type","rotate","from","0 470 -480","to","360 470 -480","dur","5","repeatCount","indefinite"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-label","Trailer Exists",1,"downloaded-icon"],["d","M480-80q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q65 0 123 19t107 53l-58 59q-38-24-81-37.5T480-800q-133 0-226.5 93.5T160-480q0 133 93.5 226.5T480-160q133 0 226.5-93.5T800-480q0-18-2-36t-6-35l65-65q11 32 17 66t6 70q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm-56-216L254-466l56-56 114 114 400-401 56 56-456 457Z"],[3,"dialogClosed","filterType","customFilter"],[1,"dialog-content",3,"click"],[1,"dialog-title"],[1,"buttons-row"],[1,"danger",3,"click"],[1,"primary",3,"click"],["title","Edit Custom Filter",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-label","Delete","title","Delete Custom Filter",1,"icon","delete-icon",3,"click"]],template:function(i,n){if(i&1){let a=M();v(0,_i,30,6,"div",2)(1,fi,39,2,"div",3),o(2,"div",4),v(3,vi,6,0,"div",5)(4,bi,4,1),r(),v(5,ki,7,9,"ng-template",null,0,I),o(7,"dialog",6,1),g("close",function(){return h(a),_(n.closeFilterDialog())}),v(9,Pi,1,2,"app-add-filter-dialog",7)(10,Fi,10,0),r()}i&2&&(b(n.inEditMode?1:0),l(3),b(n.isLoading()?3:4),l(6),b(n.isCustomFilterDialogOpen?9:10))},dependencies:[$,je,ne,xt,Mt,wt],styles:['.media-header[_ngcontent-%COMP%]{display:flex;position:sticky;top:76px;width:100%;justify-content:flex-end;background-color:var(--color-surface-container-high);color:var(--color-on-surface);align-items:center;padding:0 1rem;z-index:99}@media (width < 765px){.media-header[_ngcontent-%COMP%]{position:fixed;inset:auto 0 78px}}.media-header[_ngcontent-%COMP%]   .empty-space[_ngcontent-%COMP%]{flex:1;margin:auto}.edit[_ngcontent-%COMP%]{justify-content:flex-start;gap:1rem}@media (width < 765px){.edit[_ngcontent-%COMP%]{gap:.5rem}}.edit[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{font-weight:700;color:var(--color-primary)}@media (width < 765px){.edit[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}}.media-header-button[_ngcontent-%COMP%]{display:flex;align-items:center;font-weight:700;cursor:pointer;padding:.75rem 0}.media-header-button[_ngcontent-%COMP%]   .button-icon[_ngcontent-%COMP%]{width:2.25rem;height:2.25rem;font-size:0;margin:0;padding:.25rem;fill:var(--color-on-surface)}@media (width < 765px){.media-header-button[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}}.media-header-button[_ngcontent-%COMP%]:hover:not(.delete){color:var(--color-primary)}.media-header-button[_ngcontent-%COMP%]:hover:not(.delete)   svg[_ngcontent-%COMP%]{fill:var(--color-primary)!important}.delete[_ngcontent-%COMP%]{color:var(--color-error)}.delete[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{fill:var(--color-error)!important}.media-header-sortitem[_ngcontent-%COMP%], .media-header-filteritem[_ngcontent-%COMP%]{position:relative;display:flex;flex-wrap:nowrap;align-items:center;justify-content:flex-start;cursor:pointer;font-weight:700;padding:1rem;gap:.5rem}.icon[_ngcontent-%COMP%]{margin:0}.empty-icon[_ngcontent-%COMP%]{width:100%;height:clamp(10rem,25vh,30rem);fill:var(--color-on-surface)}.media-header-sortitem[_ngcontent-%COMP%]:hover, .media-header-filteritem[_ngcontent-%COMP%]:hover, .media-header-button[_ngcontent-%COMP%]:hover{background-color:var(--color-surface-container-highest)}.sortitem-dropdown[_ngcontent-%COMP%], .filteritem-dropdown[_ngcontent-%COMP%]{display:none;position:absolute;min-width:8rem;top:3.5rem;right:0;background-color:var(--color-surface-container-highest);z-index:100;box-shadow:.5rem 1rem 1rem 0 var(--color-shadow)}@media (width < 765px){.sortitem-dropdown[_ngcontent-%COMP%], .filteritem-dropdown[_ngcontent-%COMP%]{top:auto;bottom:3.5rem;box-shadow:.5rem -1rem 1rem 0 var(--color-shadow)}}.filteritem-dropdown[_ngcontent-%COMP%]{min-width:11rem}.media-header-sortitem[_ngcontent-%COMP%]:hover   .sortitem-dropdown[_ngcontent-%COMP%], .media-header-filteritem[_ngcontent-%COMP%]:hover   .filteritem-dropdown[_ngcontent-%COMP%]{display:flex;flex-direction:column}.sortitem-dropdown-option[_ngcontent-%COMP%], .filteritem-dropdown-option[_ngcontent-%COMP%]{display:flex;cursor:pointer;align-items:center;justify-content:space-between;gap:.5rem;font-weight:400;height:2.75rem;padding:.5rem .25rem .5rem .75rem}.sortitem-dropdown-option[_ngcontent-%COMP%]:hover, .filteritem-dropdown-option[_ngcontent-%COMP%]:hover{background-color:var(--color-secondary-container);color:var(--color-primary)}.media-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;overflow-y:auto}@media (width < 765px){.media-container[_ngcontent-%COMP%]{margin-bottom:80px}}.text-center[_ngcontent-%COMP%]{text-align:center}.center[_ngcontent-%COMP%]{margin:auto;align-content:center;min-height:70vh}.media-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(min(180px,100%),1fr));gap:1rem;padding:1rem}@media (width < 900px){.media-row[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fill,minmax(min(120px,100%),1fr));gap:.5rem;padding:.5rem}}.media-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;transition:all .4s;border-radius:10px;cursor:pointer;position:relative;overflow:hidden;background-image:url("./media/poster-sm-XZCQRTNE.png");background-repeat:no-repeat;background-size:cover}.media-card[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:pointer;display:flex;flex-direction:column}.media-card-checkbox[_ngcontent-%COMP%]{position:absolute;top:.5rem;left:.5rem;width:1.5rem;height:1.5rem;background-color:var(--color-surface-container-high);outline:2px solid var(--color-primary)}@media (width < 765px){.media-card-checkbox[_ngcontent-%COMP%]{top:.25rem;left:.25rem;width:1rem;height:1rem}}.media-card-checkbox[_ngcontent-%COMP%]:checked{outline:none;accent-color:var(--color-primary)}.media-card-checkbox[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]{border:4px solid var(--color-primary);border-radius:10px}.media-card[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{width:100%;text-align:center;background-color:var(--color-surface-container-high);color:var(--color-primary);padding:.5rem 0;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;border-radius:0 0 6px 6px}.animated-gradient[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_animateBg 2s linear infinite;background-image:linear-gradient(135deg,var(--color-surface-container-highest),var(--color-surface-container-low),var(--color-surface-container-highest),var(--color-surface-container-low));background-size:100% 450%}@keyframes _ngcontent-%COMP%_animateBg{0%{background-position:0% 100%}to{background-position:0% 0%}}.media-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:cover;overflow:hidden;width:100%;aspect-ratio:2 / 3;border-radius:6px 6px 0 0}.media-card[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{position:absolute;top:5px;height:24px;width:24px}.media-card[_ngcontent-%COMP%]   .monitored-icon[_ngcontent-%COMP%], .media-card[_ngcontent-%COMP%]   .downloaded-icon[_ngcontent-%COMP%]{fill:var(--color-info);right:5px}.media-card[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]{fill:var(--color-success)}.media-card[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{display:none}.media-card[_ngcontent-%COMP%]:hover{box-shadow:0 0 10px 5px var(--color-outline)}.dialog-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;padding:1rem;min-width:max(25vw,min(300px,80vw))}.dialog-content[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border-bottom:1px solid var(--color-outline)}.dialog-title[_ngcontent-%COMP%]{font-size:larger;font-weight:700;border-bottom:none!important;padding-bottom:.5rem;margin:1rem}.delete-icon[_ngcontent-%COMP%]{fill:var(--color-error);width:2rem;height:2rem}.buttons-row[_ngcontent-%COMP%]{display:block flex;align-items:center;justify-content:space-around;padding:1rem 0}']})}}return t})();var bt=(()=>{class t{constructor(e){this.http=e,this.tasksUrl=U.apiUrl+U.tasks,this.schedulesUrl=this.tasksUrl+"schedules",this.queueUrl=this.tasksUrl+"queue"}convertTime(e){let i=[{unit:"second",value:60},{unit:"minute",value:60},{unit:"hour",value:24},{unit:"day",value:7}];for(let{unit:n,value:a}of i){if(e<a)return`${e} ${n}${e===1?"":"s"}`;e=Math.floor(e/a)}return`${e} ${e===1?"week":"weeks"}`}convertDate(e){return e?new Date(e+"Z"):null}formatDuration(e){if(e<1)return"00:00:00";let i=Math.floor(e/3600).toString().padStart(2,"0"),n=Math.floor(e%3600/60).toString().padStart(2,"0"),a=(e%60).toString().padStart(2,"0");return`${i}:${n}:${a}`}getScheduledTasks(){return this.http.get(this.schedulesUrl).pipe(Ie(e=>Object.entries(e).map(([i,n])=>Fe(qe({id:i},n),{interval:this.convertTime(n.interval),last_run_duration:this.formatDuration(n.last_run_duration),last_run_start:this.convertDate(n.last_run_start),next_run:this.convertDate(n.next_run)}))))}getQueuedTasks(){return this.http.get(this.queueUrl).pipe(Ie(e=>Object.entries(e).map(([i,n])=>Fe(qe({id:i},n),{duration:this.formatDuration(n.duration),finished:this.convertDate(n.finished),started:this.convertDate(n.started)}))))}runScheduledTask(e){return this.http.get(this.tasksUrl+"run/"+e)}static{this.\u0275fac=function(i){return new(i||t)(J(ie))}}static{this.\u0275prov=X({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Li(t,d){t&1&&(o(0,"div",5),m(1,"div",6)(2,"div",6)(3,"div",6)(4,"div",6),r())}function Vi(t,d){if(t&1){let e=M();o(0,"td",15),g("click",function(){h(e);let n=p().$implicit,a=p(2);return n.last_run_status="Running",_(a.runTask(n.task_id))}),u(),o(1,"svg",16),m(2,"path",17),r()()}}function Ai(t,d){t&1&&(o(0,"td",18),u(),o(1,"svg",19),m(2,"path",20),r()())}function Di(t,d){if(t&1&&(o(0,"tr",12)(1,"td",10),s(2),r(),o(3,"td"),s(4),r(),o(5,"td"),s(6),q(7,"timeago"),r(),o(8,"td"),s(9),r(),o(10,"td"),s(11),r(),o(12,"td"),s(13),q(14,"timeago"),r(),v(15,Vi,3,0,"td",13)(16,Ai,3,0,"td",14),r()),t&2){let e=d.$implicit;l(2),w(e.name),l(2),w(e.interval),l(2),w(e.last_run_start?F(7,8,e.last_run_start):"Not run yet"),l(3),w(e.last_run_status),l(2),w(e.last_run_duration),l(2),w(e.next_run?F(14,10,e.next_run):"Not scheduled"),l(2),f("ngIf",e.last_run_status.toLowerCase()!="running"),l(),f("ngIf",e.last_run_status.toLowerCase()=="running")}}function Hi(t,d){if(t&1&&(o(0,"div",7)(1,"table",8)(2,"tr",9)(3,"th",10),s(4,"Name"),r(),o(5,"th"),s(6,"Interval"),r(),o(7,"th"),s(8,"Last Run"),r(),o(9,"th"),s(10,"Last Run Status"),r(),o(11,"th"),s(12,"Last Run Duration"),r(),o(13,"th"),s(14,"Next Run"),r(),m(15,"th"),r(),v(16,Di,17,12,"tr",11),r()()),t&2){let e=p();l(16),f("ngForOf",e.scheduledTasks)}}function Ni(t,d){t&1&&(o(0,"div",5),m(1,"div",6)(2,"div",6)(3,"div",6)(4,"div",6),r())}function Zi(t,d){if(t&1&&(o(0,"tr",12)(1,"td",10),s(2),r(),o(3,"td"),s(4),r(),o(5,"td"),s(6),q(7,"timeago"),r(),o(8,"td"),s(9),q(10,"timeago"),r(),o(11,"td"),s(12),r()()),t&2){let e=d.$implicit;l(2),w(e.name),l(2),w(e.status),l(2),w(e.started?F(7,5,e.started):"Pending"),l(3),w(e.finished?F(10,7,e.finished):"-"),l(3),w(e.duration)}}function Ri(t,d){if(t&1&&(o(0,"div",21)(1,"table",8)(2,"tr",9)(3,"th",10),s(4,"Name"),r(),o(5,"th"),s(6,"Status"),r(),o(7,"th"),s(8,"Started"),r(),o(9,"th"),s(10,"Finished"),r(),o(11,"th"),s(12,"Duration"),r()(),v(13,Zi,13,9,"tr",11),r()()),t&2){let e=p();l(13),f("ngForOf",e.queuedTasks)}}var yt=(()=>{class t{constructor(e,i){this.tasksService=e,this.websocketService=i,this.scheduledTasks=[],this.queuedTasks=[],this.isLoading1=!0,this.isLoading2=!0}ngOnInit(){this.refreshTaskData();let e=()=>{this.refreshTaskData()},i=()=>{clearTimeout(this.timeoutRef),this.webSocketSubscription?.unsubscribe()};this.webSocketSubscription=this.websocketService.connect().subscribe({next:e,error:i,complete:i})}getSecondsToNextScheduledEvent(e,i){let n=30;for(let a of i)if(a.status==="Running")return 10;for(let a of e){let c=new Date().getTime(),C=a.next_run.getTime(),k=Math.floor((C-c)/1e3)+2;if(k=Math.max(k,3),k===3)return 3;n=Math.min(n,k)}return n}refreshTaskData(){clearTimeout(this.timeoutRef),this.tasksService.getScheduledTasks().subscribe(i=>{this.scheduledTasks=i,this.isLoading1=!1}),this.tasksService.getQueuedTasks().subscribe(i=>{this.queuedTasks=i,this.isLoading2=!1});let e=this.getSecondsToNextScheduledEvent(this.scheduledTasks,this.queuedTasks);this.timeoutRef=setTimeout(()=>{this.refreshTaskData()},e*1e3)}ngOnDestroy(){clearTimeout(this.timeoutRef),this.webSocketSubscription?.unsubscribe()}runTask(e){this.tasksService.runScheduledTask(e).subscribe(i=>{console.log(i)})}static{this.\u0275fac=function(i){return new(i||t)(T(bt),T(de))}}static{this.\u0275cmp=S({type:t,selectors:[["app-tasks"]],features:[$e([])],decls:13,vars:4,consts:[["schedulesLoaded",""],["queueLoaded",""],[1,"tasks-container"],[1,"text-heading"],["class","loading-wave center",4,"ngIf","ngIfElse"],[1,"loading-wave","center"],[1,"loading-bar"],[1,"table-container"],[1,"tasks-table"],[1,"table-row","header"],[1,"name"],["class","table-row",4,"ngFor","ngForOf"],[1,"table-row"],["title","Run task now",3,"click",4,"ngIf"],["title","Task is running",4,"ngIf"],["title","Run task now",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960"],["d","M382-306.67 653.33-480 382-653.33v346.66ZM480-80q-82.33 0-155.33-31.5-73-31.5-127.34-85.83Q143-251.67 111.5-324.67T80-480q0-83 31.5-156t85.83-127q54.34-54 127.34-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 82.33-31.5 155.33-31.5 73-85.5 127.34Q709-143 636-111.5T480-80Z"],["title","Task is running"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960",1,"loading"],["d","M343-107q-120-42-194.5-146.5T74-490q0-29 4-57.5T91-604l-57 33-37-62 185-107 106 184-63 36-54-92q-13 30-18.5 60.5T147-490q0 113 65.5 200T381-171l-38 64Zm291-516v-73h107q-47-60-115.5-93.5T480-823q-66 0-123.5 24T255-734l-38-65q54-45 121-71t142-26q85 0 160.5 33T774-769v-67h73v213H634ZM598-1 413-107l107-184 62 37-54 94q123-17 204.5-110.5T814-489q0-19-2.5-37.5T805-563h74q4 18 6 36.5t2 36.5q0 142-87 251.5T578-96l56 33-36 62Z"],[1,"table-container","last-table"]],template:function(i,n){if(i&1&&(o(0,"div",2)(1,"div",3),s(2,"Scheduled"),r(),m(3,"hr"),v(4,Li,5,0,"div",4)(5,Hi,17,1,"ng-template",null,0,I),o(7,"div",3),s(8,"Queue"),r(),m(9,"hr"),v(10,Ni,5,0,"div",4)(11,Ri,14,1,"ng-template",null,1,I),r()),i&2){let a=E(6),c=E(12);l(4),f("ngIf",n.isLoading1)("ngIfElse",a),l(6),f("ngIf",n.isLoading1)("ngIfElse",c)}},dependencies:[te,Q,oe,Te],styles:[".tasks-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:1rem}@media (width < 765px){.tasks-container[_ngcontent-%COMP%]{padding:.5rem}}.text-heading[_ngcontent-%COMP%]{margin-top:1rem;text-align:left;font-size:2rem}.center[_ngcontent-%COMP%]{margin:auto}.table-container[_ngcontent-%COMP%]{width:100%;overflow-x:auto;min-height:25%;-webkit-overflow-scrolling:touch;margin-top:.5rem;margin-bottom:2rem}.last-table[_ngcontent-%COMP%]{margin-bottom:0}.tasks-table[_ngcontent-%COMP%]{width:100%;max-width:100%;white-space:nowrap;border-collapse:collapse}.tasks-table[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{border-bottom:1px solid var(--color-outline);white-space:nowrap;text-align:left}.tasks-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .tasks-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem .5rem}.tasks-table[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{font-weight:700;border-bottom:2px solid var(--color-outline)}.tasks-table[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:100%}.table-row[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin:0 .5rem;width:1rem;fill:var(--color-primary);cursor:pointer}.loading[_ngcontent-%COMP%]{cursor:progress;animation:spin-animation 2s linear infinite}.table-row[_ngcontent-%COMP%]:hover:not(:first-child){background-color:var(--color-tertiary-container)}"]})}}return t})();var Ot=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"media",redirectTo:"home",pathMatch:"full"},{path:"home",component:Pe},{path:"media/:mediaId",loadChildren:()=>import("./chunk-NKBCS4EK.js").then(t=>t.mediaDetailsRoutes)},{path:"movies",component:Pe},{path:"series",component:Pe},{path:"tasks",component:yt},{path:"logs",component:Ct},{path:"settings",loadChildren:()=>import("./chunk-5A4BV34N.js").then(t=>t.settingsRoutes)}];var Et={providers:[it(Ot,nt()),Ke(),{provide:We,useValue:{dateFormat:"medium",timezone:"UTC"}},De(oe.forRoot())]};var kt=(()=>{class t{static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=S({type:t,selectors:[["app-sidenav"]],decls:31,vars:0,consts:[[1,"navmenu"],["routerLink","home","routerLinkActive","active",1,"sidenav-button"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960",1,"icon"],["d","M240-200h120v-240h240v240h120v-360L480-740 240-560v360Zm-80 80v-480l320-240 320 240v480H520v-240h-80v240H160Zm320-350Z"],[1,"btntext"],["routerLink","movies","routerLinkActive","active",1,"sidenav-button"],["d","m160-800 80 160h120l-80-160h80l80 160h120l-80-160h80l80 160h120l-80-160h120q33 0 56.5 23.5T880-720v480q0 33-23.5 56.5T800-160H160q-33 0-56.5-23.5T80-240v-480q0-33 23.5-56.5T160-800Zm0 240v320h640v-320H160Zm0 0v320-320Z"],["routerLink","series","routerLinkActive","active",1,"sidenav-button"],["d","M320-120v-80H160q-33 0-56.5-23.5T80-280v-480q0-33 23.5-56.5T160-840h640q33 0 56.5 23.5T880-760v480q0 33-23.5 56.5T800-200H640v80H320ZM160-280h640v-480H160v480Zm0 0v-480 480Z"],["routerLink","tasks","routerLinkActive","active",1,"sidenav-button"],["d","M200-640h560v-80H200v80Zm0 0v-80 80Zm0 560q-33 0-56.5-23.5T120-160v-560q0-33 23.5-56.5T200-800h40v-80h80v80h320v-80h80v80h40q33 0 56.5 23.5T840-720v227q-19-9-39-15t-41-9v-43H200v400h252q7 22 16.5 42T491-80H200Zm520 40q-83 0-141.5-58.5T520-240q0-83 58.5-141.5T720-440q83 0 141.5 58.5T920-240q0 83-58.5 141.5T720-40Zm67-105 28-28-75-75v-112h-40v128l87 87Z"],["routerLink","logs","routerLinkActive","active",1,"sidenav-button"],["d","M280-280h280v-80H280v80Zm0-160h400v-80H280v80Zm0-160h400v-80H280v80Zm-80 480q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h560q33 0 56.5 23.5T840-760v560q0 33-23.5 56.5T760-120H200Zm0-80h560v-560H200v560Zm0-560v560-560Z"],["routerLink","settings","routerLinkActive","active",1,"sidenav-button"],["d","m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"a",1),u(),o(2,"svg",2),m(3,"path",3),r(),x(),o(4,"span",4),s(5,"Home"),r()(),o(6,"a",5),u(),o(7,"svg",2),m(8,"path",6),r(),x(),o(9,"span",4),s(10,"Movies"),r()(),o(11,"a",7),u(),o(12,"svg",2),m(13,"path",8),r(),x(),o(14,"span",4),s(15,"Series"),r()(),o(16,"a",9),u(),o(17,"svg",2),m(18,"path",10),r(),x(),o(19,"span",4),s(20,"Tasks"),r()(),o(21,"a",11),u(),o(22,"svg",2),m(23,"path",12),r(),x(),o(24,"span",4),s(25,"Logs"),r()(),o(26,"a",13),u(),o(27,"svg",2),m(28,"path",14),r(),x(),o(29,"span",4),s(30,"Settings"),r()()())},dependencies:[ne,tt],styles:[".navmenu[_ngcontent-%COMP%]{overflow:auto;width:210px;height:100%;margin:0;padding:0;box-sizing:border-box;display:flex;flex-direction:column;align-items:start;justify-items:stretch}.sidenav-button[_ngcontent-%COMP%]{margin:0;padding:1rem 1rem 1rem 2rem;box-sizing:border-box;width:100%;text-decoration:none;color:inherit;text-align:start;font-weight:400;display:flex;align-items:center;transition:.3s;cursor:pointer;border-radius:0;border-bottom:2px solid transparent}.sidenav-button.active[_ngcontent-%COMP%]{background-color:var(--color-secondary-container);opacity:1;font-weight:600;color:var(--color-on-secondary-container);border-bottom:2px solid var(--color-primary)}.sidenav-button[_ngcontent-%COMP%]:not(.active):hover{background-color:var(--color-secondary-container);opacity:.6;font-weight:500;color:var(--color-on-secondary-container);border-bottom:2px solid var(--color-primary)}.sidenav-button[_ngcontent-%COMP%]:last-child{margin-bottom:auto}.sidenav-button[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:0;margin-right:.5rem;height:1.75rem;width:1.75rem;padding:.25rem}@media (max-width: 1100px){.navmenu[_ngcontent-%COMP%]{width:auto}.sidenav-button[_ngcontent-%COMP%]{padding:1rem}.sidenav-button[_ngcontent-%COMP%]   .btntext[_ngcontent-%COMP%]{display:none}.sidenav-button[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:auto}}@media (max-width: 765px){.navmenu[_ngcontent-%COMP%]{flex-direction:row;width:100%;height:auto;margin:0;padding:0;padding-top:1rem;padding-bottom:1rem;justify-content:space-evenly;align-items:center}.sidenav-button[_ngcontent-%COMP%]{padding:0;width:auto;border-radius:0;border-bottom:2px solid transparent}.sidenav-button[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{margin:.5rem;height:1.75rem;width:1.75rem}.sidenav-button[_ngcontent-%COMP%]:last-child{margin-bottom:0}}"]})}}return t})();var Ui=t=>["/media/",t];function Bi(t,d){if(t&1&&m(0,"img",38),t&2){let e=p().$implicit;Ve("src",e.poster_path||"assets/poster-lg.png",Ce),Ve("alt",e.title)}}function Qi(t,d){if(t&1&&(o(0,"span",39),s(1),r()),t&2){let e=p().$implicit;l(),w(e.title+" ("+e.year+")")}}function Gi(t,d){if(t&1&&(o(0,"span",39),s(1),r()),t&2){let e=p().$implicit;l(),w(e.title)}}function $i(t,d){if(t&1){let e=M();o(0,"div",35),g("click",function(){h(e);let n=p();return _(n.searchResults=[])}),v(1,Bi,1,2,"img",36)(2,Qi,2,1,"span",37)(3,Gi,2,1,"span",37),r()}if(t&2){let e=d.$implicit,i=p();B("selected",e.id===i.selectedId),f("routerLink",e.id===-1?null:ee(6,Ui,e.id)),l(),f("ngIf",e.id>0),l(),f("ngIf",e.id>0),l(),f("ngIf",e.id<0)}}var Pt=(()=>{class t{constructor(e,i,n,a){this.renderer=e,this.mediaService=i,this.elementRef=n,this.router=a,this.isDarkModeEnabled=!0,this.searchQuery="",this.searchForm=new be,this.searchResults=[],this.selectedIndex=-1,this.selectedId=-1,this.noSearchResult={id:-1,title:"No results found",imdb_id:"",txdb_id:"",poster_path:"",year:0,youtube_trailer_id:"",is_movie:!0},this.searchForm.valueChanges.pipe(ge(400),he()).subscribe(c=>{this.onSearch(c)})}clickout(e){this.elementRef.nativeElement.contains(e.target)||(this.searchResults=[],this.selectedId=-1,this.selectedIndex=-1)}disableSelection(e){this.searchResults.length>0&&(this.selectedId=-1,this.selectedIndex=-1)}handleKeyboardEvent(e){let i=document.activeElement;if(!(i.tagName==="INPUT"||i.tagName==="TEXTAREA"||i.isContentEditable)&&e.key==="f"){e.preventDefault(),document.getElementById("searchForm")?.querySelector("input")?.focus();return}if(this.searchResults.length>0){if(e.key==="Escape"){this.searchResults=[],this.selectedId=-1,this.selectedIndex=-1;return}let a=this.searchResults[0].id,c=this.searchResults[this.searchResults.length-1].id;if(e.key==="ArrowDown"||e.key==="Tab"&&!e.shiftKey){if(e.preventDefault(),this.selectedId===c){this.selectedIndex=0,this.selectedId=a;return}this.selectedIndex=this.selectedIndex+1,this.selectedId=this.searchResults[this.selectedIndex].id;return}else if(e.key==="ArrowUp"||e.shiftKey&&e.key==="Tab"){if(e.preventDefault(),this.selectedId===a){this.selectedIndex=this.searchResults.length-1,this.selectedId=c;return}this.selectedIndex=this.selectedIndex-1,this.selectedId=this.searchResults[this.selectedIndex].id;return}else if(e.key==="Enter"){this.router.navigate(["media",this.selectedId]),this.searchResults=[];return}}}ngOnInit(){let e=localStorage.getItem("theme");if(e){let i=e==="dark";this.setTheme(i)}else window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?this.setTheme(!0):this.setTheme(!1)}onThemeChange(e){this.setTheme(!!e)}setTheme(e=!0){let i=e?"dark":"light",n=e?"light":"dark";this.isDarkModeEnabled=e,this.renderer.setAttribute(document.documentElement,"theme",i),this.renderer.removeClass(document.body,n),this.renderer.addClass(document.body,i),localStorage.setItem("theme",i)}onSearch(e=""){if(e.length<3){this.searchResults=[];return}e.trim()!==this.searchQuery&&(this.searchQuery=e,this.mediaService.searchMedia(this.searchQuery).subscribe(i=>{if(i.length===0){this.searchResults=[this.noSearchResult];return}this.searchResults=i}))}static{this.\u0275fac=function(i){return new(i||t)(T(Ne),T(Oe),T(ve),T(et))}}static{this.\u0275cmp=S({type:t,selectors:[["app-topnav"]],hostBindings:function(i,n){i&1&&g("click",function(c){return n.clickout(c)},!1,z)("mousemove",function(c){return n.disableSelection(c)},!1,z)("keydown",function(c){return n.handleKeyboardEvent(c)},!1,z)},decls:36,vars:5,consts:[[1,"navbar"],["routerLink","home",1,"navlogo"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 2260 512","alt","Trailarr Logo","height","40",1,"sm-none","trailarr"],["d","M0 90h60c0 -8.284 6.716 -15 15 -15s15 6.716 15 15h90l-75 -74H40C17.909 16 0 33.909 0 56z","fill","#d9e7ec"],["d","M60 90c0 -8.284 6.716 -15 15 -15s15 6.716 15 15z","fill","#005fe4"],["d","M180 90h120l-75 -74H105z","fill","#005fe4"],["d","M300 90h120l-75 -74H225z","fill","#d9e7ec"],["d","M420 90h92V56c0 -22.091 -17.909 -40 -40 -40H345z","fill","#005fe4"],["d","M0 90h60c0 8.284 6.716 15 15 15s15 -6.716 15 -15h90l-75 76H0z","fill","#b6c4cf"],["d","M60 90c0 8.284 6.716 15 15 15s15 -6.716 15 -15z","fill","#0040a0"],["d","M180 90h120l-75 76H105z","fill","#0040a0"],["d","M300 90h120l-75 76H225z","fill","#b6c4cf"],["d","M420 90h92v76H345z","fill","#0040a0"],["d","M0 166h256v330H40c-22.091 0 -40 -17.909 -40 -40z","fill","#ff631a"],["d","M512 166H256v330h216c22.091 0 40 -17.909 40 -40z","fill","#f03800"],["d","M256 256H100c-8.284 0 -15 6.716 -15 15s6.716 15 15 15h50v60h-50c-8.284 0 -15 6.716 -15 15s6.716 15 15 15h156v-30h-76v-60h76z","fill","#005fe4"],["d","M256 256h156c8.284 0 15 6.716 15 15s-6.716 15 -15 15h-46v60h46c8.284 0 15 6.716 15 15s-6.716 15 -15 15H256v-30h76v-60h-76z","fill","#0040a0"],["transform","translate(620 50)","fill","#006a6a","fill-rule","evenodd","stroke","#006a6a","stroke-width","0.944882","stroke-linecap","round",1,"logo-text"],["d","M0 158.208v-41.472h46.08l10.24 -59.904 48.128 -10.752v70.656h62.976l-7.168 41.472h-55.808V309.76c-0.012 1.914 0.12 3.826 0.394 5.72q1.101 7.273 5.285 10.473 0.706 0.54 1.489 0.959a32.74 32.74 0 0 0 14.521 3.817q0.675 0.024 1.351 0.023 7.168 0 14.336 -1.024 3.358 -0.475 6.684 -1.132 3.205 -0.638 6.027 -1.404l0.089 -0.024c4.317 -0.99 8.584 -2.185 12.788 -3.58l0.012 -0.004 9.728 38.4 -4.608 1.536q-1.538 0.676 -3.12 1.239 -3.176 1.143 -7.613 2.361 -1.415 0.387 -2.835 0.752 -8.96 2.304 -20.992 4.096t-26.368 1.792 -26.368 -3.072a58.7 58.7 0 0 1 -13.115 -5.002 50 50 0 0 1 -7.621 -4.982 46.5 46.5 0 0 1 -13.104 -16.664 54 54 0 0 1 -0.464 -1q-4.864 -10.752 -4.864 -26.624V158.208z"],["d","M275.968 231.424v140.288H217.6V242.688c0.012 -7.18 -0.178 -14.36 -0.57 -21.531q-0.569 -10.049 -1.705 -18.714a176 176 0 0 0 -1.821 -11.211q-4.096 -20.736 -8.704 -33.536 -5.632 -14.848 -12.288 -24.064l46.08 -18.432q4.608 5.632 9.728 13.824 3.552 6.216 7.104 14.357 0.552 1.266 1.088 2.539 4.096 9.728 6.656 23.04 7.878 -22.845 21.209 -35.842a60 60 0 0 1 8.487 -6.91q19.456 -13.056 44.032 -13.056a87 87 0 0 1 15.131 1.271c2.318 0.407 4.616 0.922 6.885 1.545l2.286 0.631q7.786 2.155 7.453 2.185h-0.011l-16.384 56.832a0.1 0.1 0 0 0 0.032 -0.006q0.189 -0.122 -5.92 -2.81 -5.733 -2.523 -16.603 -2.785 -1.298 -0.03 -2.597 -0.031 -9.216 0 -18.432 4.608t-16.384 12.544a61.2 61.2 0 0 0 -8.641 12.475 75 75 0 0 0 -3.135 6.725q-4.608 11.264 -4.608 25.088Z"],["d","M592.384 127.488V248.32c-0.012 7.18 0.166 14.36 0.534 21.531q0.899 16.924 3.306 29.925 1.23 6.687 2.731 13.318 1.346 5.909 2.776 10.964a140 140 0 0 0 2.941 9.254q3.986 10.871 8.485 18.408a60 60 0 0 0 3.803 5.656l-45.568 18.432q-6.656 -6.656 -12.288 -15.872 -4.608 -8.192 -8.704 -19.712 -3.687 -10.37 -4.885 -24.268a145 145 0 0 1 -0.235 -3.124q-8.704 30.72 -27.904 46.336 -16.95 13.786 -44.474 15.402 -3.743 0.217 -7.494 0.214c-6.874 0.036 -13.736 -0.58 -20.494 -1.84a80 80 0 0 1 -21.234 -7.12q-17.664 -8.96 -29.44 -25.6a103.8 103.8 0 0 1 -11.818 -22.197 136 136 0 0 1 -5.59 -17.995q-5.632 -23.552 -5.632 -52.224 0 -29.184 8.96 -54.016a134.2 134.2 0 0 1 15.276 -30.248 119 119 0 0 1 9.812 -12.504q16.128 -17.92 38.656 -28.16t49.664 -10.24q15.36 0 32 2.304t30.976 4.864q10.976 1.96 19.401 3.77 2.463 0.528 4.919 1.094 9.984 2.304 11.52 2.816ZM534.016 232.96v-73.728q-5.12 -1.536 -15.36 -3.584 -9.34 -1.868 -16.976 -2.032 -0.727 -0.015 -1.456 -0.016 -15.212 0 -26.198 4.069a48 48 0 0 0 -5.802 2.587Q455.68 166.912 448 178.688t-10.752 28.16 -3.072 35.84q0 17.92 1.024 34.304t5.376 29.184T453.12 326.4q8.096 7.337 21.693 7.423l0.323 0.001q12.8 0 23.552 -8.704t18.688 -22.784 12.288 -32.256 4.352 -37.12Z"],["d","M658.944 315.904V116.736h58.368v194.048a61 61 0 0 0 0.21 5.254q0.447 5.108 1.846 8.178a10 10 0 0 0 1.528 2.44q3.584 4.096 10.752 4.096H736q2.304 0 4.352 -0.512 2.048 0 4.608 -0.512l6.144 36.864q-2.74 1.565 -6.676 2.832 -1.261 0.404 -2.54 0.752 -4.608 1.536 -11.52 2.56a91 91 0 0 1 -7.345 0.767q-3.91 0.257 -8.271 0.257a73 73 0 0 1 -16.43 -1.736q-12.009 -2.771 -20.509 -9.964a45 45 0 0 1 -4.533 -4.428 55.7 55.7 0 0 1 -13.072 -27.363 78 78 0 0 1 -1.264 -14.365ZM689.152 3.072q16.384 0 25.088 9.728t8.704 25.088 -8.96 25.6 -26.368 10.24q-16.384 0 -25.344 -9.984a34.8 34.8 0 0 1 -8.933 -22.765 45 45 0 0 1 -0.027 -1.555 46.1 46.1 0 0 1 1.479 -11.966 34.9 34.9 0 0 1 7.481 -14.146q8.278 -9.46 24.202 -10.181 1.338 -0.06 2.678 -0.059Z"],["d","M789.504 316.416V10.752L847.872 0v310.784q0 9.831 3.212 14.666 0.613 0.929 1.396 1.718a14.8 14.8 0 0 0 6.372 3.694q2.298 0.686 5.053 0.857a30 30 0 0 0 1.887 0.057q5.12 0 9.984 -0.512t8.96 -1.536q4.608 -1.024 8.192 -2.048l7.168 36.864q-6.656 2.56 -14.848 4.608 -6.16 1.76 -14.211 2.953 -1.341 0.198 -2.685 0.375 -4.996 0.647 -10.025 0.94 -5.655 0.34 -11.991 0.34a84 84 0 0 1 -15.974 -1.421q-17.314 -3.367 -27.034 -14.707a56.4 56.4 0 0 1 -12.606 -27.11 78.3 78.3 0 0 1 -1.218 -14.106Z"],["d","M1139.2 127.488V248.32c-0.012 7.18 0.166 14.36 0.534 21.531q0.899 16.924 3.306 29.925 1.23 6.687 2.731 13.318 1.346 5.909 2.776 10.964a140 140 0 0 0 2.941 9.254q3.986 10.871 8.485 18.408a60 60 0 0 0 3.803 5.656l-45.568 18.432q-6.656 -6.656 -12.288 -15.872 -4.608 -8.192 -8.704 -19.712 -3.687 -10.37 -4.885 -24.268a145 145 0 0 1 -0.235 -3.124q-8.704 30.72 -27.904 46.336 -16.95 13.786 -44.474 15.402 -3.743 0.217 -7.494 0.214c-6.874 0.036 -13.736 -0.58 -20.494 -1.84a80 80 0 0 1 -21.234 -7.12q-17.664 -8.96 -29.44 -25.6a103.8 103.8 0 0 1 -11.818 -22.197 136 136 0 0 1 -5.59 -17.995q-5.632 -23.552 -5.632 -52.224 0 -29.184 8.96 -54.016a134.2 134.2 0 0 1 15.276 -30.248 119 119 0 0 1 9.812 -12.504q16.128 -17.92 38.656 -28.16t49.664 -10.24q15.36 0 32 2.304t30.976 4.864q10.976 1.96 19.401 3.77 2.463 0.528 4.919 1.094 9.984 2.304 11.52 2.816Zm-58.368 105.472v-73.728q-5.12 -1.536 -15.36 -3.584 -9.34 -1.868 -16.976 -2.032 -0.727 -0.015 -1.456 -0.016 -15.212 0 -26.198 4.069a48 48 0 0 0 -5.802 2.587q-12.544 6.656 -20.224 18.432t-10.752 28.16 -3.072 35.84q0 17.92 1.024 34.304t5.376 29.184 12.544 20.224q8.096 7.337 21.693 7.423l0.323 0.001q12.8 0 23.552 -8.704t18.688 -22.784 12.288 -32.256 4.352 -37.12Z"],["d","M1260.544 231.424v140.288h-58.368V242.688c0.012 -7.18 -0.178 -14.36 -0.57 -21.531q-0.569 -10.049 -1.705 -18.714a176 176 0 0 0 -1.821 -11.211q-4.096 -20.736 -8.704 -33.536 -5.632 -14.848 -12.288 -24.064l46.08 -18.432q4.608 5.632 9.728 13.824 3.552 6.216 7.104 14.357 0.552 1.266 1.088 2.539 4.096 9.728 6.656 23.04 7.878 -22.845 21.209 -35.842a60 60 0 0 1 8.487 -6.91q19.456 -13.056 44.032 -13.056a87 87 0 0 1 15.131 1.271c2.318 0.407 4.616 0.922 6.885 1.545l2.286 0.631q7.786 2.155 7.453 2.185h-0.011l-16.384 56.832a0.1 0.1 0 0 0 0.032 -0.006q0.189 -0.122 -5.92 -2.81 -5.733 -2.523 -16.603 -2.785 -1.299 -0.03 -2.597 -0.031 -9.216 0 -18.432 4.608t-16.384 12.544a61.2 61.2 0 0 0 -8.641 12.475 75 75 0 0 0 -3.135 6.725q-4.608 11.264 -4.608 25.088Z"],["d","M1449.472 231.424v140.288h-58.368V242.688c0.012 -7.18 -0.178 -14.36 -0.57 -21.531q-0.569 -10.049 -1.705 -18.714a176 176 0 0 0 -1.821 -11.211q-4.096 -20.736 -8.704 -33.536 -5.632 -14.848 -12.288 -24.064l46.08 -18.432q4.608 5.632 9.728 13.824 3.552 6.216 7.104 14.357 0.552 1.266 1.088 2.539 4.096 9.728 6.656 23.04 7.878 -22.845 21.209 -35.842a60 60 0 0 1 8.487 -6.91q19.456 -13.056 44.032 -13.056a87 87 0 0 1 15.131 1.271c2.318 0.407 4.616 0.922 6.885 1.545l2.286 0.631q7.786 2.155 7.453 2.185h-0.011l-16.384 56.832a0.1 0.1 0 0 0 0.032 -0.006q0.189 -0.122 -5.92 -2.81 -5.733 -2.523 -16.603 -2.785 -1.299 -0.03 -2.597 -0.031 -9.216 0 -18.432 4.608t-16.384 12.544a61.2 61.2 0 0 0 -8.641 12.475 75 75 0 0 0 -3.135 6.725q-4.608 11.264 -4.608 25.088Z"],["src","/assets/logos/trailarr.svg","alt","Trailarr Logo","width","30","height","30",1,"sm-show"],[1,"navsearch"],["id","searchForm",1,"navsearch-form"],["type","text","autocomplete","off","name","query","placeholder","Search for media...","aria-label","search",3,"formControl"],[1,"navsearch-results"],["class","title",3,"selected","routerLink","click",4,"ngFor","ngForOf"],[1,"switch2","sm-none"],["id","theme-switch","type","checkbox",3,"ngModelChange","ngModel"],[1,"slider2"],[1,"title",3,"click","routerLink"],["class","search-poster",3,"src","alt",4,"ngIf"],["class","search-title",4,"ngIf"],[1,"search-poster",3,"src","alt"],[1,"search-title"]],template:function(i,n){i&1&&(o(0,"div",0)(1,"a",1),u(),o(2,"svg",2)(3,"g"),m(4,"path",3)(5,"path",4)(6,"path",5)(7,"path",6)(8,"path",7)(9,"path",8)(10,"path",9)(11,"path",10)(12,"path",11)(13,"path",12)(14,"path",13)(15,"path",14)(16,"path",15)(17,"path",16),r(),o(18,"g",17),m(19,"path",18)(20,"path",19)(21,"path",20)(22,"path",21)(23,"path",22)(24,"path",23)(25,"path",24)(26,"path",25),r()(),x(),m(27,"img",26),r(),o(28,"div",27)(29,"form",28),m(30,"input",29),r(),o(31,"div",30),v(32,$i,4,8,"div",31),r()(),o(33,"label",32)(34,"input",33),Ge("ngModelChange",function(c){return Qe(n.isDarkModeEnabled,c)||(n.isDarkModeEnabled=c),c}),g("ngModelChange",function(c){return n.onThemeChange(c)}),r(),m(35,"span",34),r()()),i&2&&(l(30),f("formControl",n.searchForm),l(),B("active",n.searchResults.length>0),l(),f("ngForOf",n.searchResults),l(2),Be("ngModel",n.isDarkModeEnabled))},dependencies:[ne,$,se,re,ot,ae,le,rt,Se,ce,ye,te,Q],styles:['.navbar[_ngcontent-%COMP%]{padding:1rem .5rem;display:flex;justify-content:space-between;align-items:center;flex-direction:row;width:100%}.navlogo[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;font-size:1.5rem;font-weight:500;color:var(--color-on-surface);text-decoration:none;margin:0;padding:0;width:210px}.trailarr[_ngcontent-%COMP%]   .logo-text[_ngcontent-%COMP%]{fill:var(--color-on-surface)}.trailarr[_ngcontent-%COMP%]:hover   .logo-text[_ngcontent-%COMP%]{fill:var(--color-primary)}.navlogotext[_ngcontent-%COMP%]{margin-left:.5rem}.navsearch[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;justify-content:center;width:auto;flex-grow:1;padding:.25rem;position:relative}.navsearch-form[_ngcontent-%COMP%]{width:100%}.navsearch-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid var(--color-outline);border-radius:.5rem;margin:0;font-size:1rem;background-color:var(--color-surface-container-highest);color:var(--color-on-surface)}.navsearch-form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:var(--color-primary);border:1px solid var(--color-primary)}.navsearch-results[_ngcontent-%COMP%]{position:absolute;top:100%;left:2%;color:var(--color-on-surface);background-color:var(--color-surface-container-highest);border:.5px solid var(--color-outline);border-radius:5px;visibility:hidden;opacity:0;display:none;z-index:10}.active[_ngcontent-%COMP%]{visibility:visible;opacity:1;display:flex;flex-direction:column;max-height:40vh;max-width:60vw;overflow-x:hidden;overflow-y:auto;padding:.5rem;scroll-behavior:smooth;scroll-snap-type:y mandatory;transition:.25s}@media (width < 765px){.active[_ngcontent-%COMP%]{max-width:75vw}}.navsearch-results[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;min-width:300px;width:auto;padding:.5rem;text-align:left;text-wrap:pretty;cursor:pointer}.search-poster[_ngcontent-%COMP%]{width:3rem}.search-title[_ngcontent-%COMP%]{margin:auto .5rem;text-align:left}.navsearch-results[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]:hover, .navsearch-results[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]:focus, .navsearch-results[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{background-color:var(--color-surface-variant);outline:none}.navsearch-results[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]:focus, .navsearch-results[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{scroll-snap-align:center}@media (max-width: 900px){.navlogo[_ngcontent-%COMP%]{width:auto;padding-left:1rem;padding-right:1rem}.navlogotext[_ngcontent-%COMP%]{display:none}}.switch2[_ngcontent-%COMP%]{margin:0 1rem;display:block;--width-of-switch: 3.5em;--height-of-switch: 2em;--size-of-icon: 1.4em;--slider-offset: .3em;position:relative;width:var(--width-of-switch);height:var(--height-of-switch)}.switch2[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider2[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#fff;transition:.5s;border-radius:30px}.slider2[_ngcontent-%COMP%]:before{position:absolute;content:"";height:var(--size-of-icon, 1.4em);width:var(--size-of-icon, 1.4em);border-radius:20px;left:var(--slider-offset, .3em);top:50%;transform:translateY(-50%);background:linear-gradient(40deg,#775651,#904b40 70%);transition:.5s}input[_ngcontent-%COMP%]:checked + .slider2[_ngcontent-%COMP%]{background-color:#140c0b}input[_ngcontent-%COMP%]:checked + .slider2[_ngcontent-%COMP%]:before{left:calc(100% - (var(--size-of-icon, 1.4em) + var(--slider-offset, .3em)));background:#140c0b;box-shadow:inset -3px -2px 5px -2px #e7bdb6,inset -10px -4px #ffb4a8}']})}}return t})();var zi=["sessionEndedDialog"];function ji(t,d){if(t&1&&(o(0,"div",16)(1,"span"),s(2),r()()),t&2){let e=d.$implicit;f("ngClass",e.type.toLowerCase()),l(2),w(e.message)}}var qt=(()=>{class t{constructor(e){this.websocketService=e,this.messages=[],this.IDLE_LIMIT=10*60*1e3}ngOnInit(){this.resetIdleTimer(),this.toastSubscription=this.websocketService.toastMessage.subscribe({next:e=>{this.messages.unshift(e),setTimeout(()=>{this.messages.pop()},3e3)}})}resetIdleTimer(){clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>{this.closeAllSubscriptions()},this.IDLE_LIMIT)}closeAllSubscriptions(){console.log("Session Idle, closing all subscriptions!"),this.showDialog(),this.websocketService.close(),this.toastSubscription?.unsubscribe(),document.cookie="trailarr_api_key=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"}ngOnDestroy(){this.closeAllSubscriptions(),this.timeoutId&&clearTimeout(this.timeoutId)}showDialog(){this.sessionEndedDialog.nativeElement.showModal()}reloadPage(){window.location.reload()}static{this.\u0275fac=function(i){return new(i||t)(T(de))}}static{this.\u0275cmp=S({type:t,selectors:[["app-root"]],viewQuery:function(i,n){if(i&1&&xe(zi,5),i&2){let a;Me(a=we())&&(n.sessionEndedDialog=a.first)}},hostBindings:function(i,n){i&1&&g("click",function(c){return n.resetIdleTimer(c)},!1,z)("keypress",function(c){return n.resetIdleTimer(c)},!1,z)},decls:25,vars:1,consts:[["sessionEndedDialog",""],[1,"mainroot"],[1,"topnavbar"],[1,"mainbody"],[1,"sidebar"],[1,"main-content"],[1,"toast-container"],["class","toast",3,"ngClass",4,"ngFor","ngForOf"],[1,"dialog-content",3,"click"],[1,"loading-container"],[1,"loading-container-inner"],[1,"dash","first"],[1,"dash","seconde"],[1,"dash","third"],[1,"dash","fourth"],["tabindex","1",1,"secondary",3,"click"],[1,"toast",3,"ngClass"]],template:function(i,n){if(i&1){let a=M();o(0,"div",1)(1,"header",2),m(2,"app-topnav"),r(),o(3,"div",3)(4,"div",4),m(5,"app-sidenav"),r(),o(6,"div",5),m(7,"router-outlet"),r()(),o(8,"div",6),v(9,ji,3,2,"div",7),r()(),o(10,"dialog",null,0)(12,"div",8),g("click",function(C){return h(a),_(C.stopPropagation())}),o(13,"h2"),s(14,"Session Timed Out!"),r(),o(15,"p"),s(16,"You we gone for a while, we closed your session!"),r(),o(17,"div",9)(18,"div",10),m(19,"div",11)(20,"div",12)(21,"div",13)(22,"div",14),r()(),o(23,"button",15),g("click",function(){return h(a),_(n.reloadPage())}),s(24,"Refresh"),r()()()}i&2&&(l(9),f("ngForOf",n.messages))},dependencies:[Je,Pt,kt,Q,ze],styles:[".mainroot[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;background-color:var(--color-background);color:var(--color-on-background);position:relative}@media (width < 765px){.mainroot[_ngcontent-%COMP%]{height:auto}}.topnavbar[_ngcontent-%COMP%]{width:100%;height:auto;z-index:100;position:sticky;top:0;background-color:var(--color-surface-container);color:var(--color-on-surface)}.mainbody[_ngcontent-%COMP%]{margin:0;display:flex;flex-direction:row;flex:1 1 auto;background-color:var(--color-surface);color:var(--color-on-surface)}@media (width < 765px){.mainbody[_ngcontent-%COMP%]{flex-direction:column}}.sidebar[_ngcontent-%COMP%]{width:auto;z-index:100;background-color:var(--color-surface-container);color:var(--color-on-surface);order:1;position:sticky;top:76px;height:calc(100vh - 76px)}@media (width < 765px){.sidebar[_ngcontent-%COMP%]{width:100%;height:auto;position:fixed;bottom:0;top:auto;left:0;order:2}}.main-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1 1 auto;order:2;background-color:var(--color-surface);color:var(--color-on-surface)}@media (width < 765px){.main-content[_ngcontent-%COMP%]{order:1;margin:.5rem;margin-bottom:80px}}.toast-container[_ngcontent-%COMP%]{position:fixed;top:5rem;right:3rem;z-index:999;max-width:25%;padding:1rem;display:flex;flex-direction:column;gap:1rem}@media (width < 765px){.toast-container[_ngcontent-%COMP%]{max-width:80%;right:1rem;padding:.5rem}}.toast[_ngcontent-%COMP%]{text-wrap:wrap;padding:1rem;border-radius:.5rem;background-color:var(--color-surface-container-high);color:var(--color-on-surface);animation:_ngcontent-%COMP%_slideInRight .3s ease-out forwards}.info[_ngcontent-%COMP%]{background-color:var(--color-info);color:var(--color-info-text)}.success[_ngcontent-%COMP%]{background-color:var(--color-success);color:var(--color-success-text)}.error[_ngcontent-%COMP%]{background-color:var(--color-warning);color:var(--color-warning-text)}@keyframes _ngcontent-%COMP%_slideInRight{0%{transform:translate(100%);opacity:0}to{transform:translate(0);opacity:1}}.dialog-content[_ngcontent-%COMP%]{padding:1rem}.loading-container[_ngcontent-%COMP%]{position:relative;height:6rem;margin:1rem}.loading-container-inner[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex}.dash[_ngcontent-%COMP%]{margin:0 15px;width:35px;height:15px;border-radius:8px;background:var(--color-primary);box-shadow:var(--color-surface-tint) 0 0 15px 0}.first[_ngcontent-%COMP%]{margin-right:-18px;transform-origin:center left;animation:_ngcontent-%COMP%_spin 3s linear infinite}.seconde[_ngcontent-%COMP%]{transform-origin:center right;animation:_ngcontent-%COMP%_spin2 3s linear infinite;animation-delay:.2s}.third[_ngcontent-%COMP%]{transform-origin:center right;animation:_ngcontent-%COMP%_spin3 3s linear infinite;animation-delay:.3s}.fourth[_ngcontent-%COMP%]{transform-origin:center right;animation:_ngcontent-%COMP%_spin4 3s linear infinite;animation-delay:.4s}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}25%{transform:rotate(360deg)}30%{transform:rotate(370deg)}35%{transform:rotate(360deg)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_spin2{0%{transform:rotate(0)}20%{transform:rotate(0)}30%{transform:rotate(-180deg)}35%{transform:rotate(-190deg)}40%{transform:rotate(-180deg)}78%{transform:rotate(-180deg)}95%{transform:rotate(-360deg)}98%{transform:rotate(-370deg)}to{transform:rotate(-360deg)}}@keyframes _ngcontent-%COMP%_spin3{0%{transform:rotate(0)}27%{transform:rotate(0)}40%{transform:rotate(180deg)}45%{transform:rotate(190deg)}50%{transform:rotate(180deg)}62%{transform:rotate(180deg)}75%{transform:rotate(360deg)}80%{transform:rotate(370deg)}85%{transform:rotate(360deg)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_spin4{0%{transform:rotate(0)}38%{transform:rotate(0)}60%{transform:rotate(-360deg)}65%{transform:rotate(-370deg)}75%{transform:rotate(-360deg)}to{transform:rotate(-360deg)}}"]})}}return t})();Ye(qt,Et).catch(t=>console.error(t));
